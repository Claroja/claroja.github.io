import{_ as a}from"./plugin-vue_export-helper-x3n3nnut.js";import{r as t,o as e,c as p,b as n,d as o,e as c,a as i}from"./app-7knaTE3M.js";const u={},l=i(`<h1 id="select" tabindex="-1"><a class="header-anchor" href="#select" aria-hidden="true">#</a> select</h1><h2 id="数据准备" tabindex="-1"><a class="header-anchor" href="#数据准备" aria-hidden="true">#</a> 数据准备</h2><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#39;a&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">&#39;b&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&#39;a&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;b&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;c&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">&#39;c&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;A&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;B&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;C&quot;</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">&quot;&quot;&quot;
   a  b  c
0  1  a  A
1  2  b  B
2  3  c  C
&quot;&quot;&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="行选择" tabindex="-1"><a class="header-anchor" href="#行选择" aria-hidden="true">#</a> 行选择</h2><h3 id="普通选择" tabindex="-1"><a class="header-anchor" href="#普通选择" aria-hidden="true">#</a> 普通选择</h3><ol><li><p>如果[x,y]中,x,y都是普通数值,则返回一个普通值, 例如:选择一行一列,返回的是一个<code>numpy.int64</code>对象</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">&#39;a&#39;</span><span class="token punctuation">]</span>
<span class="token triple-quoted-string string">&quot;&quot;&quot;
2
&quot;&quot;&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>如果[x,y]中,x和y有一个是列表类型(<code>:</code>range列表或<code>[]</code>lable列表或<code>[true,false]</code>布尔列表),则返回的是<code>Series</code>对象, 例如:选择一行多列数据, 注意此时返回的是一个<code>pandas.core.series.Series</code>对象</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token comment"># 等价于df.loc[1]</span>
<span class="token triple-quoted-string string">&quot;&quot;&quot;
a    2
b    b
c    B
&quot;&quot;&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>选择多行一列数据, 此时返回的是一个<code>pandas.core.series.Series</code>对象</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">&#39;a&#39;</span><span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>如果[x,y]中,x和y都是列表类型,则返回的是<code>DataFrame</code>对象, 例如: 选择多行多列数据, 此时返回的是一个<code>pandas.core.frame.DataFrame</code>对象</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">&#39;a&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;b&#39;</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>如果y,不给出,既[x]形式, 则默认选择所有y, 等价于<code>[x,:]</code></p></li></ol><h3 id="条件选择" tabindex="-1"><a class="header-anchor" href="#条件选择" aria-hidden="true">#</a> 条件选择</h3><ol><li><p>首先设置条件</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>condition <span class="token operator">=</span> df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token number">2</span> <span class="token comment"># 值判断, 等价于df[&quot;a&quot;]&gt;2</span>
condition <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>isin<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># 包含关系判断</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>然后使用<code>loc</code>进行选择</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>condition<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token comment"># 这一步就是给[x,y],中的x传入的一个boolean的列表</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>给条件筛选加上逻辑判断</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">]</span><span class="token operator">&lt;</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><table><thead><tr><th>符号</th><th>描述</th></tr></thead><tbody><tr><td>\`</td><td>\`</td></tr><tr><td><code>&amp;</code></td><td>and</td></tr><tr><td><code>~</code></td><td>not</td></tr></tbody></table></li></ol><h3 id="步长选择" tabindex="-1"><a class="header-anchor" href="#步长选择" aria-hidden="true">#</a> 步长选择</h3><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment">#选择1:2行，slice为1</span>
   a  b  c
<span class="token number">1</span>  <span class="token number">2</span>  b  B
<span class="token number">2</span>  <span class="token number">3</span>  c  C
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment">#选择所有行，slice为-1，所以为倒序</span>
   a  b  c
<span class="token number">2</span>  <span class="token number">3</span>  c  C
<span class="token number">1</span>  <span class="token number">2</span>  b  B
<span class="token number">0</span>  <span class="token number">1</span>  a  A
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment">#选择0至2行，slice为2，等同于print(df.loc[0:2:2,:])因为只有3行</span>
   a  b  c
<span class="token number">0</span>  <span class="token number">1</span>  a  A
<span class="token number">2</span>  <span class="token number">3</span>  c  C
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="pandas的值引用与地址引用" tabindex="-1"><a class="header-anchor" href="#pandas的值引用与地址引用" aria-hidden="true">#</a> pandas的值引用与地址引用</h2><p><code>df[mask]</code> 返回了一个新的<code>DataFrame</code>对象 <code>df[mask][&quot;c&quot;] = 0</code>仅仅更改了新<code>DataFrame</code>对象的值, 而没有改变最初的<code>df</code>的值</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">&quot;b&quot;</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">&quot;c&quot;</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
mask <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">&quot;c&quot;</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">8</span>
<span class="token triple-quoted-string string">&quot;&quot;&quot;
0     True
1    False
2    False
&quot;&quot;&quot;</span>
df<span class="token punctuation">[</span>mask<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&quot;c&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>  <span class="token comment"># 这里没有更改原df的值, 会抛出warn：SettingWithCopyWarning</span>
df
<span class="token triple-quoted-string string">&quot;&quot;&quot;
   a  b  c
0  1  4  7
1  2  5  8
2  3  6  9
&quot;&quot;&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>df[&quot;z&quot;]</code> 返回一个地址, 指向<code>df</code>的<code>z</code>列 <code>df[&quot;z&quot;][mask] = 0</code> 更改了<code>df</code>的<code>z</code>列的值</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>df<span class="token punctuation">[</span><span class="token string">&quot;z&quot;</span><span class="token punctuation">]</span><span class="token punctuation">[</span>mask<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>  <span class="token comment"># 更改了原df的值</span>
df
<span class="token triple-quoted-string string">&quot;&quot;&quot;
   a  b  c
0  1  4  0
1  2  5  8
2  3  6  9
&quot;&quot;&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>为例便面无解, 建议使用 <code>.loc</code></p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>mask<span class="token punctuation">,</span> <span class="token string">&quot;z&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>
df
<span class="token triple-quoted-string string">&quot;&quot;&quot;
   a  b  c
0  1  4  0
1  2  5  8
2  3  6  9
&quot;&quot;&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="总结summary" tabindex="-1"><a class="header-anchor" href="#总结summary" aria-hidden="true">#</a> 总结summary</h2><table><thead><tr><th>action</th><th>return</th><th>assign</th></tr></thead><tbody><tr><td><code>df.loc[mask, column_name]</code></td><td>return copy</td><td>assign value to copy</td></tr><tr><td><code>df[mask][column_name]</code></td><td>return copy</td><td>assign value to copy</td></tr><tr><td><code>df[column_name][mask]</code></td><td>return copy</td><td>assign value to df</td></tr></tbody></table>`,19),d={href:"https://realpython.com/pandas-settingwithcopywarning/",target:"_blank",rel:"noopener noreferrer"};function r(k,m){const s=t("ExternalLinkIcon");return e(),p("div",null,[l,n("p",null,[n("a",d,[o("参考"),c(s)])])])}const h=a(u,[["render",r],["__file","选择select_行选择.html.vue"]]);export{h as default};
