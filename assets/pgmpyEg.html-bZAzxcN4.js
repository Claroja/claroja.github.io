import{_ as t}from"./plugin-vue_export-helper-x3n3nnut.js";import{o as p,c as e,a as n,b as s,e as a}from"./app-MTzDpLgJ.js";const o={},c=n("h1",{id:"selector",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#selector","aria-hidden":"true"},"#"),s(" selector")],-1),l=n("h2",{id:"student",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#student","aria-hidden":"true"},"#"),s(" Student")],-1),i=n("p",null,"有四个名称指代贝叶斯网络:",-1),u=n("ol",null,[n("li",null,"Bayesian network"),n("li",null,"belief network"),n("li",null,"Bayes(ian) model"),n("li",null,"probabilistic directed acyclic graphical model 通过一个有向无环图将一系列的变量和他们的条件依赖连接起来.")],-1),r=n("p",null,[s("贝叶斯网络的参数使用条件概率分布(CPD). 每一个节点使用"),n("span",{class:"katex"},[n("span",{class:"katex-mathml"},[n("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[n("semantics",null,[n("mrow",null,[n("mi",null,"P"),n("mo",{stretchy:"false"},"("),n("mi",null,"n"),n("mi",null,"o"),n("mi",null,"d"),n("mi",null,"e"),n("mi",{mathvariant:"normal"},"∣"),n("mi",null,"P"),n("mi",null,"a"),n("mo",{stretchy:"false"},"("),n("mi",null,"n"),n("mi",null,"o"),n("mi",null,"d"),n("mi",null,"e"),n("mo",{stretchy:"false"},")"),n("mo",{stretchy:"false"},")")]),n("annotation",{encoding:"application/x-tex"},"P(node | Pa(node))")])])]),n("span",{class:"katex-html","aria-hidden":"true"},[n("span",{class:"base"},[n("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),n("span",{class:"mord mathnormal",style:{"margin-right":"0.13889em"}},"P"),n("span",{class:"mopen"},"("),n("span",{class:"mord mathnormal"},"n"),n("span",{class:"mord mathnormal"},"o"),n("span",{class:"mord mathnormal"},"d"),n("span",{class:"mord mathnormal"},"e"),n("span",{class:"mord"},"∣"),n("span",{class:"mord mathnormal",style:{"margin-right":"0.13889em"}},"P"),n("span",{class:"mord mathnormal"},"a"),n("span",{class:"mopen"},"("),n("span",{class:"mord mathnormal"},"n"),n("span",{class:"mord mathnormal"},"o"),n("span",{class:"mord mathnormal"},"d"),n("span",{class:"mord mathnormal"},"e"),n("span",{class:"mclose"},"))")])])]),s("表示, 其中"),n("span",{class:"katex"},[n("span",{class:"katex-mathml"},[n("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[n("semantics",null,[n("mrow",null,[n("mi",null,"P"),n("mi",null,"a"),n("mo",{stretchy:"false"},"("),n("mi",null,"n"),n("mi",null,"o"),n("mi",null,"d"),n("mi",null,"e"),n("mo",{stretchy:"false"},")")]),n("annotation",{encoding:"application/x-tex"},"Pa(node)")])])]),n("span",{class:"katex-html","aria-hidden":"true"},[n("span",{class:"base"},[n("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),n("span",{class:"mord mathnormal",style:{"margin-right":"0.13889em"}},"P"),n("span",{class:"mord mathnormal"},"a"),n("span",{class:"mopen"},"("),n("span",{class:"mord mathnormal"},"n"),n("span",{class:"mord mathnormal"},"o"),n("span",{class:"mord mathnormal"},"d"),n("span",{class:"mord mathnormal"},"e"),n("span",{class:"mclose"},")")])])]),s("是父节点. 下图是student模型: "),n("a",{href:"1.png"},"1.png"),s(" 在pgmpy中, 我们定义网络结构和每个节点的CPDs, 然后将他们联系起来.")],-1),k=a(`<div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">from</span> pgmpy<span class="token punctuation">.</span>models <span class="token keyword">import</span> BayesianModel
<span class="token keyword">from</span> pgmpy<span class="token punctuation">.</span>factors<span class="token punctuation">.</span>discrete <span class="token keyword">import</span> TabularCPD
<span class="token comment">## 定义网络结构, 每个元组填入两个节点, 第一个节点指向第二个节点</span>
model <span class="token operator">=</span> BayesianModel<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">&#39;D&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;G&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">&#39;I&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;G&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">&#39;G&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;L&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">&#39;I&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;S&#39;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment">## 定义每个节点的CPD</span>
<span class="token comment">### 独立节点的CPD定义,variable:变量名/variable_card:变量种类个数/values:变量各种类值</span>
cpd_d <span class="token operator">=</span> TabularCPD<span class="token punctuation">(</span>variable<span class="token operator">=</span><span class="token string">&#39;D&#39;</span><span class="token punctuation">,</span> variable_card<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> values<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0.6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0.4</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># D节点, 有两个变量, 值分别是0.6和0.4</span>
cpd_i <span class="token operator">=</span> TabularCPD<span class="token punctuation">(</span>variable<span class="token operator">=</span><span class="token string">&#39;I&#39;</span><span class="token punctuation">,</span> variable_card<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> values<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0.7</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0.3</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment">### 非独立节点的CPD定义, 列：evidence 行：state</span>
<span class="token comment">##    +---------+---------+---------+---------+---------+</span>
<span class="token comment">##    | diff    | intel_0 | intel_0 | intel_1 | intel_1 |</span>
<span class="token comment">##    +---------+---------+---------+---------+---------+</span>
<span class="token comment">##    | intel   | diff_0  | diff_1  | diff_0  | diff_1  |</span>
<span class="token comment">##    +---------+---------+---------+---------+---------+</span>
<span class="token comment">##    | grade_0 | 0.3     | 0.05    | 0.9     | 0.5     |</span>
<span class="token comment">##    +---------+---------+---------+---------+---------+</span>
<span class="token comment">##    | grade_1 | 0.4     | 0.25    | 0.08    | 0.3     |</span>
<span class="token comment">##    +---------+---------+---------+---------+---------+</span>
<span class="token comment">##    | grade_2 | 0.3     | 0.7     | 0.02    | 0.2     |</span>
<span class="token comment">##    +---------+---------+---------+---------+---------+</span>
<span class="token comment">## evidence:证据或父节点/evidence_card:证据或父节点变量种类个数</span>
cpd_g <span class="token operator">=</span> TabularCPD<span class="token punctuation">(</span>variable<span class="token operator">=</span><span class="token string">&#39;G&#39;</span><span class="token punctuation">,</span> variable_card<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token comment"># 当前节点G有三种情况</span>
                   values<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0.3</span><span class="token punctuation">,</span> <span class="token number">0.05</span><span class="token punctuation">,</span> <span class="token number">0.9</span><span class="token punctuation">,</span>  <span class="token number">0.5</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token comment"># 各种情况各个值</span>
                           <span class="token punctuation">[</span><span class="token number">0.4</span><span class="token punctuation">,</span> <span class="token number">0.25</span><span class="token punctuation">,</span> <span class="token number">0.08</span><span class="token punctuation">,</span> <span class="token number">0.3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                           <span class="token punctuation">[</span><span class="token number">0.3</span><span class="token punctuation">,</span> <span class="token number">0.7</span><span class="token punctuation">,</span>  <span class="token number">0.02</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  evidence<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;I&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;D&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment"># 证据或父节点</span>
                  evidence_card<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># I变量有两种情况, D变量有两种情况</span>
cpd_l <span class="token operator">=</span> TabularCPD<span class="token punctuation">(</span>variable<span class="token operator">=</span><span class="token string">&#39;L&#39;</span><span class="token punctuation">,</span> variable_card<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>
                   values<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0.4</span><span class="token punctuation">,</span> <span class="token number">0.99</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                           <span class="token punctuation">[</span><span class="token number">0.9</span><span class="token punctuation">,</span> <span class="token number">0.6</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   evidence<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;G&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   evidence_card<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
cpd_s <span class="token operator">=</span> TabularCPD<span class="token punctuation">(</span>variable<span class="token operator">=</span><span class="token string">&#39;S&#39;</span><span class="token punctuation">,</span> variable_card<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>
                   values<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0.95</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                           <span class="token punctuation">[</span><span class="token number">0.05</span><span class="token punctuation">,</span> <span class="token number">0.8</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   evidence<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;I&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   evidence_card<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment">## 将条件概率分布加入到贝叶斯网络中</span>
model<span class="token punctuation">.</span>add_cpds<span class="token punctuation">(</span>cpd_d<span class="token punctuation">,</span> cpd_i<span class="token punctuation">,</span> cpd_g<span class="token punctuation">,</span> cpd_l<span class="token punctuation">,</span> cpd_s<span class="token punctuation">)</span>
<span class="token comment">## 检验模型参数的正确性, 既验证CPD和是否为1</span>
model<span class="token punctuation">.</span>check_model<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>默认各个节点变量分类没有名称, 从0开始命名, 可以给各个类别加上别名</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>cpd_d_sn <span class="token operator">=</span> TabularCPD<span class="token punctuation">(</span>variable<span class="token operator">=</span><span class="token string">&#39;D&#39;</span><span class="token punctuation">,</span> variable_card<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> values<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0.6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0.4</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> state_names<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&#39;D&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&#39;Easy&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Hard&#39;</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
cpd_i_sn <span class="token operator">=</span> TabularCPD<span class="token punctuation">(</span>variable<span class="token operator">=</span><span class="token string">&#39;I&#39;</span><span class="token punctuation">,</span> variable_card<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> values<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0.7</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0.3</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> state_names<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&#39;I&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&#39;Dumb&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Intelligent&#39;</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
cpd_g_sn <span class="token operator">=</span> TabularCPD<span class="token punctuation">(</span>variable<span class="token operator">=</span><span class="token string">&#39;G&#39;</span><span class="token punctuation">,</span> variable_card<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span>
                      values<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0.3</span><span class="token punctuation">,</span> <span class="token number">0.05</span><span class="token punctuation">,</span> <span class="token number">0.9</span><span class="token punctuation">,</span>  <span class="token number">0.5</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                              <span class="token punctuation">[</span><span class="token number">0.4</span><span class="token punctuation">,</span> <span class="token number">0.25</span><span class="token punctuation">,</span> <span class="token number">0.08</span><span class="token punctuation">,</span> <span class="token number">0.3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                              <span class="token punctuation">[</span><span class="token number">0.3</span><span class="token punctuation">,</span> <span class="token number">0.7</span><span class="token punctuation">,</span>  <span class="token number">0.02</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      evidence<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;I&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;D&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      evidence_card<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      state_names<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&#39;G&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&#39;A&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;B&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;C&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                                   <span class="token string">&#39;I&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&#39;Dumb&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Intelligent&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                                   <span class="token string">&#39;D&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&#39;Easy&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Hard&#39;</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
cpd_l_sn <span class="token operator">=</span> TabularCPD<span class="token punctuation">(</span>variable<span class="token operator">=</span><span class="token string">&#39;L&#39;</span><span class="token punctuation">,</span> variable_card<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>
                      values<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0.4</span><span class="token punctuation">,</span> <span class="token number">0.99</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                              <span class="token punctuation">[</span><span class="token number">0.9</span><span class="token punctuation">,</span> <span class="token number">0.6</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      evidence<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;G&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      evidence_card<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      state_names<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&#39;L&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&#39;Bad&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Good&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                                   <span class="token string">&#39;G&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&#39;A&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;B&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;C&#39;</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
cpd_s_sn <span class="token operator">=</span> TabularCPD<span class="token punctuation">(</span>variable<span class="token operator">=</span><span class="token string">&#39;S&#39;</span><span class="token punctuation">,</span> variable_card<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>
                      values<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0.95</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                              <span class="token punctuation">[</span><span class="token number">0.05</span><span class="token punctuation">,</span> <span class="token number">0.8</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      evidence<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;I&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      evidence_card<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      state_names<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&#39;S&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&#39;Bad&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Good&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                                   <span class="token string">&#39;I&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&#39;Dumb&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Intelligent&#39;</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
model<span class="token punctuation">.</span>add_cpds<span class="token punctuation">(</span>cpd_d_sn<span class="token punctuation">,</span> cpd_i_sn<span class="token punctuation">,</span> cpd_g_sn<span class="token punctuation">,</span> cpd_l_sn<span class="token punctuation">,</span> cpd_s_sn<span class="token punctuation">)</span>
model<span class="token punctuation">.</span>check_model<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>
<span class="token keyword">import</span> networkx <span class="token keyword">as</span> nx
<span class="token keyword">from</span> matplotlib <span class="token keyword">import</span> pyplot <span class="token keyword">as</span> plt
<span class="token comment">## 绘制网络结构图，并附上概率分布表</span>
nx<span class="token punctuation">.</span>draw<span class="token punctuation">(</span>model<span class="token punctuation">,</span>
        with_labels<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
        node_size<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">,</span>
        font_weight<span class="token operator">=</span><span class="token string">&#39;bold&#39;</span><span class="token punctuation">,</span>
        node_color<span class="token operator">=</span><span class="token string">&#39;y&#39;</span><span class="token punctuation">,</span>
        pos<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;L&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">&quot;G&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">&quot;S&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">&quot;D&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">&quot;I&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> model<span class="token punctuation">.</span>get_cpds<span class="token punctuation">(</span><span class="token string">&quot;D&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">&#39;b&#39;</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> model<span class="token punctuation">.</span>get_cpds<span class="token punctuation">(</span><span class="token string">&quot;I&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">&#39;b&#39;</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> model<span class="token punctuation">.</span>get_cpds<span class="token punctuation">(</span><span class="token string">&quot;G&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">&#39;b&#39;</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token number">4.2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> model<span class="token punctuation">.</span>get_cpds<span class="token punctuation">(</span><span class="token string">&quot;L&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">&#39;b&#39;</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">3.4</span><span class="token punctuation">,</span> model<span class="token punctuation">.</span>get_cpds<span class="token punctuation">(</span><span class="token string">&quot;S&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">&#39;b&#39;</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">&#39;test&#39;</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>model<span class="token punctuation">.</span>get_cpds<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 获得所有cpd对象</span>
<span class="token triple-quoted-string string">&#39;&#39;&#39;
[&lt;TabularCPD representing P(D:2) at 0x7f1585d3e278&gt;,
 &lt;TabularCPD representing P(I:2) at 0x7f1585d3e320&gt;,
 &lt;TabularCPD representing P(G:3 | I:2, D:2) at 0x7f1585d3e390&gt;,
 &lt;TabularCPD representing P(L:2 | G:3) at 0x7f1585d3e2b0&gt;,
 &lt;TabularCPD representing P(S:2 | I:2) at 0x7f1585d3e358&gt;]
&#39;&#39;&#39;</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>cpd_g<span class="token punctuation">)</span> <span class="token comment"># 打印CPD, 没有state names</span>
<span class="token triple-quoted-string string">&#39;&#39;&#39;
+------+------+------+------+------+
| I    | I(0) | I(0) | I(1) | I(1) |
+------+------+------+------+------+
| D    | D(0) | D(1) | D(0) | D(1) |
+------+------+------+------+------+
| G(0) | 0.3  | 0.05 | 0.9  | 0.5  |
+------+------+------+------+------+
| G(1) | 0.4  | 0.25 | 0.08 | 0.3  |
+------+------+------+------+------+
| G(2) | 0.3  | 0.7  | 0.02 | 0.2  |
+------+------+------+------+------+
&#39;&#39;&#39;</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>model<span class="token punctuation">.</span>get_cpds<span class="token punctuation">(</span><span class="token string">&#39;G&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 查看某个节点的条件概率分布, 带有state names</span>
<span class="token triple-quoted-string string">&#39;&#39;&#39;
+------+---------+---------+----------------+----------------+
| I    | I(Dumb) | I(Dumb) | I(Intelligent) | I(Intelligent) |
+------+---------+---------+----------------+----------------+
| D    | D(Easy) | D(Hard) | D(Easy)        | D(Hard)        |
+------+---------+---------+----------------+----------------+
| G(A) | 0.3     | 0.05    | 0.9            | 0.5            |
+------+---------+---------+----------------+----------------+
| G(B) | 0.4     | 0.25    | 0.08           | 0.3            |
+------+---------+---------+----------------+----------------+
| G(C) | 0.3     | 0.7     | 0.02           | 0.2            |
+------+---------+---------+----------------+----------------+
&#39;&#39;&#39;</span>
model<span class="token punctuation">.</span>get_cardinality<span class="token punctuation">(</span><span class="token string">&#39;G&#39;</span><span class="token punctuation">)</span> <span class="token comment"># 获得G节点, 元素个数</span>
<span class="token triple-quoted-string string">&#39;&#39;&#39;
3
&#39;&#39;&#39;</span>



</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="独立" tabindex="-1"><a class="header-anchor" href="#独立" aria-hidden="true">#</a> 独立</h3><ol><li>Local Independencies:在给定$$X$$父节点的条件下, $$X$$独立于非子孙节点, 既:</li></ol>`,7),d=n("p",{class:"katex-block"},[n("span",{class:"katex-display"},[n("span",{class:"katex"},[n("span",{class:"katex-mathml"},[n("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[n("semantics",null,[n("mrow",null,[n("mi",null,"X"),n("mi",{mathvariant:"normal"},"⊥"),n("mi",null,"N"),n("mi",null,"o"),n("mi",null,"n"),n("mi",null,"D"),n("mi",null,"e"),n("mi",null,"s"),n("mi",null,"c"),n("mo",{stretchy:"false"},"("),n("mi",null,"X"),n("mo",{stretchy:"false"},")"),n("mi",{mathvariant:"normal"},"∣"),n("msub",null,[n("mi",null,"P"),n("mi",null,"a")]),n("mo",{stretchy:"false"},"("),n("mi",null,"X"),n("mo",{stretchy:"false"},")")]),n("annotation",{encoding:"application/x-tex"}," X\\bot NonDesc(X)|P_a(X) ")])])]),n("span",{class:"katex-html","aria-hidden":"true"},[n("span",{class:"base"},[n("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),n("span",{class:"mord mathnormal",style:{"margin-right":"0.07847em"}},"X"),n("span",{class:"mord"},"⊥"),n("span",{class:"mord mathnormal",style:{"margin-right":"0.10903em"}},"N"),n("span",{class:"mord mathnormal"},"o"),n("span",{class:"mord mathnormal"},"n"),n("span",{class:"mord mathnormal"},"Desc"),n("span",{class:"mopen"},"("),n("span",{class:"mord mathnormal",style:{"margin-right":"0.07847em"}},"X"),n("span",{class:"mclose"},")"),n("span",{class:"mord"},"∣"),n("span",{class:"mord"},[n("span",{class:"mord mathnormal",style:{"margin-right":"0.13889em"}},"P"),n("span",{class:"msupsub"},[n("span",{class:"vlist-t vlist-t2"},[n("span",{class:"vlist-r"},[n("span",{class:"vlist",style:{height:"0.1514em"}},[n("span",{style:{top:"-2.55em","margin-left":"-0.1389em","margin-right":"0.05em"}},[n("span",{class:"pstrut",style:{height:"2.7em"}}),n("span",{class:"sizing reset-size6 size3 mtight"},[n("span",{class:"mord mathnormal mtight"},"a")])])]),n("span",{class:"vlist-s"},"​")]),n("span",{class:"vlist-r"},[n("span",{class:"vlist",style:{height:"0.15em"}},[n("span")])])])])]),n("span",{class:"mopen"},"("),n("span",{class:"mord mathnormal",style:{"margin-right":"0.07847em"}},"X"),n("span",{class:"mclose"},")")])])])])],-1),m=a(`<p class="katex-block"><span class="katex-error" title="ParseError: KaTeX parse error: Can&#39;t use function &#39;$&#39; in math mode at position 12: 
NonDesc(X)$̲$表示非$$X$$的子孙节点
…" style="color:#cc0000;"> NonDesc(X)$$表示非$$X$$的子孙节点 $$P_a(X)$$表示$$X$$的父节点 2. Global Independencies: 第一种情况:两个节点直接连接, 无论方向 [2.png](2.png) 无论更改任何节点都会影响另一个. [3.png](3.png) 第二种情况: Causal: 当$B$被观察时,将阻断$A \\rightarrow C$的影响, $(A \\perp C | B)$ Evidential: 当$B$被观察时,将阻断$A \\rightarrow C$的影响,$(A \\perp C | B)$ Common Evidence: 当B未知时, 将阻断$A \\rightarrow C$的影响,$(A \\perp C )$ Common Cause: 当$B$被观察时,将阻断$A \\rightarrow C$的影响,$(A \\perp C | B)$ \`\`\`python ## Getting the local independencies of a variable. model.local_independencies(&#39;G&#39;) &#39;&#39;&#39; (G _|_ S | I, D) &#39;&#39;&#39; ## Getting all the local independencies in the network. model.local_independencies([&#39;D&#39;, &#39;I&#39;, &#39;S&#39;, &#39;G&#39;, &#39;L&#39;]) &#39;&#39;&#39; (D _|_ I, S) (I _|_ D) (S _|_ G, L, D | I) (G _|_ S | I, D) (L _|_ I, D, S | G) &#39;&#39;&#39; ## Active trail: For any two variables A and B in a network if any change in A influences the values of B then we say ## that there is an active trail between A and B. ## In pgmpy active_trail_nodes gives a set of nodes which are affected (i.e. correlated) by any ## change in the node passed in the argument. model.active_trail_nodes(&#39;D&#39;) &#39;&#39;&#39; {&#39;D&#39;: {&#39;D&#39;, &#39;G&#39;, &#39;L&#39;}} &#39;&#39;&#39; model.active_trail_nodes(&#39;D&#39;, observed=&#39;G&#39;) &#39;&#39;&#39; {&#39;D&#39;: {&#39;D&#39;, &#39;I&#39;, &#39;S&#39;}} &#39;&#39;&#39; \`\`\` ### Inference \`\`\`python from pgmpy.inference import VariableElimination infer = VariableElimination(model) g_dist = infer.query([&#39;G&#39;]) print(g_dist) &#39;&#39;&#39; +------+----------+ | G | phi(G) | +======+==========+ | G(A) | 0.3620 | +------+----------+ | G(B) | 0.2884 | +------+----------+ | G(C) | 0.3496 | +------+----------+ &#39;&#39;&#39; print(infer.query([&#39;G&#39;], evidence={&#39;D&#39;: &#39;Easy&#39;, &#39;I&#39;: &#39;Intelligent&#39;})) &#39;&#39;&#39; +------+----------+ | G | phi(G) | +======+==========+ | G(A) | 0.9000 | +------+----------+ | G(B) | 0.0800 | +------+----------+ | G(C) | 0.0200 | +------+----------+ &#39;&#39;&#39; infer.map_query([&#39;G&#39;]) &#39;&#39;&#39; {&#39;G&#39;: &#39;A&#39;} &#39;&#39;&#39; infer.map_query([&#39;G&#39;], evidence={&#39;D&#39;: &#39;Easy&#39;, &#39;I&#39;: &#39;Intelligent&#39;}) &#39;&#39;&#39; {&#39;G&#39;: &#39;A&#39;} &#39;&#39;&#39; \`\`\` 参考： https://pgmpy.org/detailed_notebooks/2.%20Bayesian%20Networks.html https://blog.csdn.net/weixin_41599977/article/details/90320390 ## Monty Hall Problem [4.png](4.png) ### 背景 假设你在一个游戏中, 你可以选择三扇门: 其中一扇门是汽车, 另外两个是山羊. 你先选择了一扇门, 比如第一扇门, 然后主持人(他之后每扇门背后是山羊还是车), 打开第三扇门, 里面是山羊. 然后, 他对你说:&quot;你是否换到第二扇门?&quot; 直觉上, 换或者不换均有1/2的概率赢得汽车.然而正确的结论非常的反直觉, 更换选择后会有2/3的概率赢得汽车, 而不更换的概率只有1/3. 以上结论可以使用蒙特卡洛方法验证: \`\`\`python import random def Monty_Hall_simulation(strategy, simulation_number): wins_count = 0 # Simulated 100000 times based on monte carlo for i in range(simulation_number): # 0 means car and 1,2 means goats choice_list_init = [0, 1, 2] first_choice = random.choice(choice_list_init) # According to the precondition, the compere helps us eliminate an error option, so the sample must include the # car and a goat. if first_choice == 0: # the first time we choice the car sample_space = [0, random.choice([1, 2])] else: sample_space = [0, first_choice] # Counting the simulation results on the condition of stick the first choice or change the choice. if strategy == &#39;stick&#39;: result = first_choice if strategy == &#39;change&#39;: sample_space.pop(sample_space.index(first_choice)) result = sample_space[0] if result == 0: wins_count += 1 win_probability = round(wins_count/simulation_number, 6) print(&quot;The probability of win in {0} strategy is {1}: &quot; .format(strategy, win_probability)) Monty_Hall_simulation(&#39;change&#39;, 100000) Monty_Hall_simulation(&#39;stick&#39;, 100000) \`\`\` 一个直觉上的解释: 汽车有1/3的概率在玩家第一次挑选的门的后面, 比如下面的第一扇门. 而有2/3个概率是在另外两扇门后面. 当主持人打开了第三扇门, 如果玩家此时更换选择, 相当于同时选择了两扇门(一扇门没有开, 另一扇门主持人打开为羊), 既概率为2/3. [5.png](5.png) ### 贝叶斯网络 我们有三个随机变量, 1. 选择玩家(Contestant)的选择:$$C \\in {1, 2, 3}$$, 玩家将随机选择门,所以$$P(C=1) = P(C=2) = P(C=3) = \\frac{1}{3}</span></p><ol start="2"><li>主持人(Host)的选择:$$H :nbsphinx-math:in {1, 2, 3}$$,$$ P :nbsphinx-math:in {1, 2, 3 } $$</li><li>奖品(Prize)随机放在门后, 所以$$P(P=1) = P(P=2) = P(P=3) = :nbsphinx-math:\\frac{1}{3}$$ 所以可以构建如下的网络结构: <a href="6.png">6.png</a> 假设玩家选了了第0扇门, 主持人开了第2扇门, 我们要算的就是获得奖品的概率:$$P(P | H=2, C=0)$$</li></ol><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">from</span> pgmpy<span class="token punctuation">.</span>models <span class="token keyword">import</span> BayesianModel
<span class="token keyword">from</span> pgmpy<span class="token punctuation">.</span>factors<span class="token punctuation">.</span>discrete <span class="token keyword">import</span> TabularCPD

<span class="token comment">## Defining the network structure</span>
model <span class="token operator">=</span> BayesianModel<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">&#39;C&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;H&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">&#39;P&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;H&#39;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment">## Defining the CPDs:</span>
cpd_c <span class="token operator">=</span> TabularCPD<span class="token punctuation">(</span><span class="token string">&#39;C&#39;</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0.33</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0.33</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0.33</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
cpd_p <span class="token operator">=</span> TabularCPD<span class="token punctuation">(</span><span class="token string">&#39;P&#39;</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0.33</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0.33</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0.33</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
cpd_h <span class="token operator">=</span> TabularCPD<span class="token punctuation">(</span><span class="token string">&#39;H&#39;</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                            <span class="token punctuation">[</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                            <span class="token punctuation">[</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                    evidence<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;C&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;P&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> evidence_card<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment">## Associating the CPDs with the network structure.</span>
model<span class="token punctuation">.</span>add_cpds<span class="token punctuation">(</span>cpd_c<span class="token punctuation">,</span> cpd_p<span class="token punctuation">,</span> cpd_h<span class="token punctuation">)</span>

<span class="token comment">## check_model check for the model structure and the associated CPD and returns True if everything is correct otherwise throws an exception</span>
model<span class="token punctuation">.</span>check_model<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">## Infering the posterior probability</span>
<span class="token keyword">from</span> pgmpy<span class="token punctuation">.</span>inference <span class="token keyword">import</span> VariableElimination

infer <span class="token operator">=</span> VariableElimination<span class="token punctuation">(</span>model<span class="token punctuation">)</span>
posterior_p <span class="token operator">=</span> infer<span class="token punctuation">.</span>query<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;P&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> evidence<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&#39;C&#39;</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">&#39;H&#39;</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>posterior_p<span class="token punctuation">)</span>
<span class="token triple-quoted-string string">&#39;&#39;&#39;
+------+----------+
| P    |   phi(P) |
+======+==========+
| P(0) |   0.3333 |
+------+----------+
| P(1) |   0.6667 |
+------+----------+
| P(2) |   0.0000 |
+------+----------+
&#39;&#39;&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>参考: https://en.wikipedia.org/wiki/Monty_Hall_problem https://zhuanlan.zhihu.com/p/48254298 https://pgmpy.org/examples/Monty%20Hall%20Problem.html</p><h2 id="earthquake-network" tabindex="-1"><a class="header-anchor" href="#earthquake-network" aria-hidden="true">#</a> Earthquake Network</h2><p>安装了盗窃警报( burglar alarm ), 它可以观测盗窃和地震.两个邻居,约翰和玛丽承诺当听见报警器响会通知警察. 约翰有时会被电话铃迷惑, 当电话响时也会报警. 玛丽喜欢比较大声的音乐, 所以会错过报警器. <a href="7.png">7.png</a></p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">from</span> pgmpy<span class="token punctuation">.</span>models <span class="token keyword">import</span> BayesianModel
<span class="token keyword">from</span> pgmpy<span class="token punctuation">.</span>inference <span class="token keyword">import</span> VariableElimination
<span class="token keyword">from</span> pgmpy<span class="token punctuation">.</span>factors<span class="token punctuation">.</span>discrete <span class="token keyword">import</span> TabularCPD

<span class="token comment">#Defining network structure</span>
alarm_model <span class="token operator">=</span> BayesianModel<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">&#39;Burglary&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Alarm&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                                <span class="token punctuation">(</span><span class="token string">&#39;Earthquake&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Alarm&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                                <span class="token punctuation">(</span><span class="token string">&#39;Alarm&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;JohnCalls&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                                <span class="token punctuation">(</span><span class="token string">&#39;Alarm&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;MaryCalls&#39;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment">#Defining the parameters using CPT</span>
cpd_burglary <span class="token operator">=</span> TabularCPD<span class="token punctuation">(</span>variable<span class="token operator">=</span><span class="token string">&#39;Burglary&#39;</span><span class="token punctuation">,</span> variable_card<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>
                        values<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">.999</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0.001</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
cpd_earthquake <span class="token operator">=</span> TabularCPD<span class="token punctuation">(</span>variable<span class="token operator">=</span><span class="token string">&#39;Earthquake&#39;</span><span class="token punctuation">,</span> variable_card<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>
                        values<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0.998</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0.002</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
cpd_alarm <span class="token operator">=</span> TabularCPD<span class="token punctuation">(</span>variable<span class="token operator">=</span><span class="token string">&#39;Alarm&#39;</span><span class="token punctuation">,</span> variable_card<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>
                        values<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0.999</span><span class="token punctuation">,</span> <span class="token number">0.71</span><span class="token punctuation">,</span> <span class="token number">0.06</span><span class="token punctuation">,</span> <span class="token number">0.05</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                                <span class="token punctuation">[</span><span class="token number">0.001</span><span class="token punctuation">,</span> <span class="token number">0.29</span><span class="token punctuation">,</span> <span class="token number">0.94</span><span class="token punctuation">,</span> <span class="token number">0.95</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                        evidence<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;Burglary&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Earthquake&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                        evidence_card<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
cpd_johncalls <span class="token operator">=</span> TabularCPD<span class="token punctuation">(</span>variable<span class="token operator">=</span><span class="token string">&#39;JohnCalls&#39;</span><span class="token punctuation">,</span> variable_card<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>
                        values<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0.95</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0.05</span><span class="token punctuation">,</span> <span class="token number">0.9</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                        evidence<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;Alarm&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> evidence_card<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
cpd_marycalls <span class="token operator">=</span> TabularCPD<span class="token punctuation">(</span>variable<span class="token operator">=</span><span class="token string">&#39;MaryCalls&#39;</span><span class="token punctuation">,</span> variable_card<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>
                        values<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0.7</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0.9</span><span class="token punctuation">,</span> <span class="token number">0.3</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                        evidence<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;Alarm&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> evidence_card<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment">## Associating the parameters with the model structure</span>
alarm_model<span class="token punctuation">.</span>add_cpds<span class="token punctuation">(</span>cpd_burglary<span class="token punctuation">,</span> cpd_earthquake<span class="token punctuation">,</span> cpd_alarm<span class="token punctuation">,</span> cpd_johncalls<span class="token punctuation">,</span> cpd_marycalls<span class="token punctuation">)</span>

<span class="token comment">## Checking if the cpds are valid for the model</span>
alarm_model<span class="token punctuation">.</span>check_model<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">&#39;&#39;&#39;
True
&#39;&#39;&#39;</span>

<span class="token comment">## Viewing nodes of the model</span>
alarm_model<span class="token punctuation">.</span>nodes<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">&#39;&#39;&#39;
NodeView((&#39;Burglary&#39;, &#39;Alarm&#39;, &#39;Earthquake&#39;, &#39;JohnCalls&#39;, &#39;MaryCalls&#39;))
&#39;&#39;&#39;</span>
<span class="token comment">## Viewing edges of the model</span>
alarm_model<span class="token punctuation">.</span>edges<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">&#39;&#39;&#39;
OutEdgeView([(&#39;Burglary&#39;, &#39;Alarm&#39;), (&#39;Alarm&#39;, &#39;JohnCalls&#39;), (&#39;Alarm&#39;, &#39;MaryCalls&#39;), (&#39;Earthquake&#39;, &#39;Alarm&#39;)])
&#39;&#39;&#39;</span>
<span class="token comment">#Checking independcies of a node</span>
alarm_model<span class="token punctuation">.</span>local_independencies<span class="token punctuation">(</span><span class="token string">&#39;Burglary&#39;</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">&#39;&#39;&#39;
(Burglary ⟂ Earthquake)
&#39;&#39;&#39;</span>
<span class="token comment">#Listing all Independencies</span>
alarm_model<span class="token punctuation">.</span>get_independencies<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">&#39;&#39;&#39;
(JohnCalls ⟂ Burglary, MaryCalls, Earthquake | Alarm)
(JohnCalls ⟂ MaryCalls, Earthquake | Burglary, Alarm)
(JohnCalls ⟂ Burglary, Earthquake | Alarm, MaryCalls)
(JohnCalls ⟂ Burglary, MaryCalls | Alarm, Earthquake)
(JohnCalls ⟂ Earthquake | Burglary, MaryCalls, Alarm)
(JohnCalls ⟂ MaryCalls | Burglary, Earthquake, Alarm)
(JohnCalls ⟂ Burglary | Alarm, MaryCalls, Earthquake)
(MaryCalls ⟂ JohnCalls, Burglary, Earthquake | Alarm)
(MaryCalls ⟂ Burglary, Earthquake | JohnCalls, Alarm)
(MaryCalls ⟂ JohnCalls, Earthquake | Burglary, Alarm)
(MaryCalls ⟂ JohnCalls, Burglary | Alarm, Earthquake)
(MaryCalls ⟂ Earthquake | JohnCalls, Burglary, Alarm)
(MaryCalls ⟂ Burglary | JohnCalls, Alarm, Earthquake)
(MaryCalls ⟂ JohnCalls | Burglary, Earthquake, Alarm)
(Earthquake ⟂ Burglary)
(Earthquake ⟂ JohnCalls, MaryCalls | Alarm)
(Earthquake ⟂ MaryCalls | JohnCalls, Alarm)
(Earthquake ⟂ JohnCalls, MaryCalls | Burglary, Alarm)
(Earthquake ⟂ JohnCalls | Alarm, MaryCalls)
(Earthquake ⟂ MaryCalls | JohnCalls, Burglary, Alarm)
(Earthquake ⟂ JohnCalls | Burglary, MaryCalls, Alarm)
(Burglary ⟂ Earthquake)
(Burglary ⟂ JohnCalls, MaryCalls | Alarm)
(Burglary ⟂ MaryCalls | JohnCalls, Alarm)
(Burglary ⟂ JohnCalls | Alarm, MaryCalls)
(Burglary ⟂ JohnCalls, MaryCalls | Alarm, Earthquake)
(Burglary ⟂ MaryCalls | JohnCalls, Alarm, Earthquake)
(Burglary ⟂ JohnCalls | Alarm, MaryCalls, Earthquake)
&#39;&#39;&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>参考: https://pgmpy.org/examples/Earthquake.html https://bayesian-intelligence.com/publications/bai/book/BAI_Chapter2.pdf</p>`,8),v=[c,l,i,u,r,k,d,m];function b(g,h){return p(),e("div",null,v)}const C=t(o,[["render",b],["__file","pgmpyEg.html.vue"]]);export{C as default};
