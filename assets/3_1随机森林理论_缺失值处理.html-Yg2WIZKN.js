import{_ as n}from"./plugin-vue_export-helper-x3n3nnut.js";import{o as t,c as e,a as l,b as s,d as a}from"./app-nD1Z-e8V.js";const m="/assets/5-3Zp1s5le.png",i="/assets/6-tTdKOlxQ.png",r="/assets/7-HrB9PoCe.png",c="/assets/8-ZioJZbiP.png",p="/assets/9-DzsVqOhh.png",o="/assets/10-DjfjQOO5.png",h="/assets/11-f97xghOg.png",g="/assets/12-nv1uDKEw.png",d="/assets/13-8uJABH5H.png",u="/assets/14-e2pxB0ts.png",y="/assets/15--sS--hQ-.png",f={},_=l('<h2 id="缺失值的处理" tabindex="-1"><a class="header-anchor" href="#缺失值的处理" aria-hidden="true">#</a> 缺失值的处理</h2><p>随机森林考虑2种缺失值:</p><ol><li>训练集中的缺失值</li><li>测试集中的缺失值</li></ol><h3 id="初始猜测" tabindex="-1"><a class="header-anchor" href="#初始猜测" aria-hidden="true">#</a> 初始猜测</h3><p>如下图, 第4条数据中分类变量<code>Blocked arteries</code>和数值变量<code>weight</code>都是未知的.</p><figure><img src="'+m+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>首先, 处理分类变量<code>Blocked arteries</code>. 在<code>Heart Idsease = No</code>的样本中, <code>Blocked arteries = No</code>概率是2/2=100%, 所以<code>No</code>是初始的猜测.</p><figure><img src="'+i+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>然后, 处理数值变量<code>weight</code>, 以初始猜测是<code>heart disease = No</code>样本中的平均值.</p><figure><img src="'+r+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="改善猜测" tabindex="-1"><a class="header-anchor" href="#改善猜测" aria-hidden="true">#</a> 改善猜测</h3><p>我们通过将具有缺失值的记录和相似记录来改善猜测.</p><ol><li>步骤1:</li></ol><p>不做任何处理, 创建随机森林模型, 并跑所有数据.</p><ol start="2"><li>步骤2: 构建相似度矩阵</li></ol><p>我们在第一棵树上, 看到样本3和样本4停在相同的叶子节点, 这就意味着他们是相似的.</p><figure><img src="'+c+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>适用近似矩阵(Proximity Matrix)来跟踪相似的样本, 其每一行是一个样本, 每一列是一个样本, 因为样本3和样本4结束再相同的叶子节点, 所以在他们的相交格子+1.</p><figure><img src="'+p+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>同样的方法, 跑完所有的数据, 最终得到下图的相似矩阵:</p><figure><img src="'+o+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>相似矩阵中的每个值除以树的个数, 这里有10棵树, 所以都除以10:</p><figure><img src="'+h+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ol start="3"><li>步骤3: 使用近似度矩阵与分类的权重估算最终结果</li></ol><p>现在, 使用近似值来优化样本4的缺失值.</p><p>对于<code>blocked arteries</code>, 计算自身的<code>Yes</code>和<code>No</code>的频率权重:</p>',26),x=s("ol",null,[s("li",null,[s("p",{class:"katex-block"},[s("span",{class:"katex-display"},[s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[s("semantics",null,[s("mrow",null,[s("mi",null,"Y"),s("mi",null,"E"),s("mi",null,"S"),s("mo",null,"="),s("mn",null,"1"),s("mi",{mathvariant:"normal"},"/"),s("mn",null,"3")]),s("annotation",{encoding:"application/x-tex"}," YES = 1/3 ")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6833em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.22222em"}},"Y"),s("span",{class:"mord mathnormal",style:{"margin-right":"0.05764em"}},"ES"),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),s("span",{class:"mord"},"1/3")])])])])])]),s("li",null,[s("p",{class:"katex-block"},[s("span",{class:"katex-display"},[s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[s("semantics",null,[s("mrow",null,[s("mi",null,"N"),s("mi",null,"O"),s("mo",null,"="),s("mn",null,"2"),s("mi",{mathvariant:"normal"},"/"),s("mn",null,"3")]),s("annotation",{encoding:"application/x-tex"}," NO = 2/3 ")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6833em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.02778em"}},"NO"),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),s("span",{class:"mord"},"2/3")])])])])])])],-1),b=s("p",null,[a("计算"),s("code",null,"Yes"),a("的近似权重频率:")],-1),v=s("p",{class:"katex-block"},[s("span",{class:"katex-display"},[s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[s("semantics",null,[s("mrow",null,[s("mi",null,"Y"),s("mi",null,"E"),s("mi",null,"S"),s("mo",null,"="),s("mi",{mathvariant:"normal"},'"'),s("mi",null,"Y"),s("mi",null,"E"),s("mi",null,"S"),s("mi",{mathvariant:"normal"},'"'),s("mi",null,"w"),s("mi",null,"e"),s("mi",null,"i"),s("mi",null,"g"),s("mi",null,"h"),s("mi",null,"t"),s("mi",null,"e"),s("mi",null,"d"),s("mi",null,"f"),s("mi",null,"r"),s("mi",null,"e"),s("mi",null,"q"),s("mi",null,"u"),s("mi",null,"e"),s("mi",null,"n"),s("mi",null,"c"),s("mi",null,"y"),s("mo",null,"⋅"),s("mfrac",null,[s("mrow",null,[s("mi",null,"P"),s("mi",null,"r"),s("mi",null,"o"),s("mi",null,"x"),s("mi",null,"i"),s("mi",null,"m"),s("mi",null,"i"),s("mi",null,"t"),s("mi",null,"y"),s("mi",null,"o"),s("mi",null,"f"),s("mi",{mathvariant:"normal"},'"'),s("mi",null,"Y"),s("mi",null,"E"),s("mi",null,"S"),s("mi",{mathvariant:"normal"},'"')]),s("mrow",null,[s("mi",null,"A"),s("mi",null,"l"),s("mi",null,"l"),s("mi",null,"P"),s("mi",null,"r"),s("mi",null,"o"),s("mi",null,"x"),s("mi",null,"i"),s("mi",null,"m"),s("mi",null,"i"),s("mi",null,"t"),s("mi",null,"i"),s("mi",null,"e"),s("mi",null,"s")])]),s("mo",null,"="),s("mfrac",null,[s("mn",null,"1"),s("mn",null,"3")]),s("mo",null,"⋅"),s("mfrac",null,[s("mn",null,"0.1"),s("mrow",null,[s("mn",null,"0.1"),s("mo",null,"+"),s("mn",null,"0.1"),s("mo",null,"+"),s("mn",null,"0.8")])]),s("mo",null,"="),s("mn",null,"0.03")]),s("annotation",{encoding:"application/x-tex"},' YES="YES" weighted frequency \\cdot \\frac{Proximity of "YES"}{All Proximities} = \\frac{1}{3} \\cdot \\frac{0.1}{0.1+0.1+0.8} = 0.03 ')])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6833em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.22222em"}},"Y"),s("span",{class:"mord mathnormal",style:{"margin-right":"0.05764em"}},"ES"),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.8889em","vertical-align":"-0.1944em"}}),s("span",{class:"mord"},'"'),s("span",{class:"mord mathnormal",style:{"margin-right":"0.22222em"}},"Y"),s("span",{class:"mord mathnormal",style:{"margin-right":"0.05764em"}},"ES"),s("span",{class:"mord"},'"'),s("span",{class:"mord mathnormal",style:{"margin-right":"0.02691em"}},"w"),s("span",{class:"mord mathnormal"},"e"),s("span",{class:"mord mathnormal"},"i"),s("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"g"),s("span",{class:"mord mathnormal"},"h"),s("span",{class:"mord mathnormal"},"t"),s("span",{class:"mord mathnormal"},"e"),s("span",{class:"mord mathnormal",style:{"margin-right":"0.10764em"}},"df"),s("span",{class:"mord mathnormal"},"re"),s("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"q"),s("span",{class:"mord mathnormal"},"u"),s("span",{class:"mord mathnormal"},"e"),s("span",{class:"mord mathnormal"},"n"),s("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"cy"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"⋅"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"2.0574em","vertical-align":"-0.686em"}}),s("span",{class:"mord"},[s("span",{class:"mopen nulldelimiter"}),s("span",{class:"mfrac"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"1.3714em"}},[s("span",{style:{top:"-2.314em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal"},"A"),s("span",{class:"mord mathnormal",style:{"margin-right":"0.13889em"}},"llP"),s("span",{class:"mord mathnormal"},"ro"),s("span",{class:"mord mathnormal"},"x"),s("span",{class:"mord mathnormal"},"imi"),s("span",{class:"mord mathnormal"},"t"),s("span",{class:"mord mathnormal"},"i"),s("span",{class:"mord mathnormal"},"es")])]),s("span",{style:{top:"-3.23em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"frac-line",style:{"border-bottom-width":"0.04em"}})]),s("span",{style:{top:"-3.677em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.13889em"}},"P"),s("span",{class:"mord mathnormal"},"ro"),s("span",{class:"mord mathnormal"},"x"),s("span",{class:"mord mathnormal"},"imi"),s("span",{class:"mord mathnormal"},"t"),s("span",{class:"mord mathnormal"},"yo"),s("span",{class:"mord mathnormal",style:{"margin-right":"0.10764em"}},"f"),s("span",{class:"mord"},'"'),s("span",{class:"mord mathnormal",style:{"margin-right":"0.22222em"}},"Y"),s("span",{class:"mord mathnormal",style:{"margin-right":"0.05764em"}},"ES"),s("span",{class:"mord"},'"')])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.686em"}},[s("span")])])])]),s("span",{class:"mclose nulldelimiter"})]),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"2.0074em","vertical-align":"-0.686em"}}),s("span",{class:"mord"},[s("span",{class:"mopen nulldelimiter"}),s("span",{class:"mfrac"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"1.3214em"}},[s("span",{style:{top:"-2.314em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord"},[s("span",{class:"mord"},"3")])]),s("span",{style:{top:"-3.23em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"frac-line",style:{"border-bottom-width":"0.04em"}})]),s("span",{style:{top:"-3.677em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord"},[s("span",{class:"mord"},"1")])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.686em"}},[s("span")])])])]),s("span",{class:"mclose nulldelimiter"})]),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"⋅"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"2.0908em","vertical-align":"-0.7693em"}}),s("span",{class:"mord"},[s("span",{class:"mopen nulldelimiter"}),s("span",{class:"mfrac"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"1.3214em"}},[s("span",{style:{top:"-2.314em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord"},[s("span",{class:"mord"},"0.1"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"+"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mord"},"0.1"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"+"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mord"},"0.8")])]),s("span",{style:{top:"-3.23em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"frac-line",style:{"border-bottom-width":"0.04em"}})]),s("span",{style:{top:"-3.677em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord"},[s("span",{class:"mord"},"0.1")])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.7693em"}},[s("span")])])])]),s("span",{class:"mclose nulldelimiter"})]),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6444em"}}),s("span",{class:"mord"},"0.03")])])])])],-1),w=s("p",null,[a("计算"),s("code",null,"No"),a("的近似权重频率:")],-1),k=s("p",{class:"katex-block"},[s("span",{class:"katex-display"},[s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[s("semantics",null,[s("mrow",null,[s("mi",null,"N"),s("mi",null,"O"),s("mo",null,"="),s("mfrac",null,[s("mn",null,"2"),s("mn",null,"3")]),s("mo",null,"⋅"),s("mfrac",null,[s("mrow",null,[s("mn",null,"0.1"),s("mo",null,"+"),s("mn",null,"0.8")]),s("mrow",null,[s("mn",null,"0.1"),s("mo",null,"+"),s("mn",null,"0.1"),s("mo",null,"+"),s("mn",null,"0.8")])]),s("mo",null,"="),s("mn",null,"0.6")]),s("annotation",{encoding:"application/x-tex"}," NO = \\frac{2}{3} \\cdot \\frac{0.1+0.8}{0.1+0.1+0.8} = 0.6 ")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6833em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.02778em"}},"NO"),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"2.0074em","vertical-align":"-0.686em"}}),s("span",{class:"mord"},[s("span",{class:"mopen nulldelimiter"}),s("span",{class:"mfrac"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"1.3214em"}},[s("span",{style:{top:"-2.314em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord"},[s("span",{class:"mord"},"3")])]),s("span",{style:{top:"-3.23em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"frac-line",style:{"border-bottom-width":"0.04em"}})]),s("span",{style:{top:"-3.677em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord"},[s("span",{class:"mord"},"2")])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.686em"}},[s("span")])])])]),s("span",{class:"mclose nulldelimiter"})]),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"⋅"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"2.0908em","vertical-align":"-0.7693em"}}),s("span",{class:"mord"},[s("span",{class:"mopen nulldelimiter"}),s("span",{class:"mfrac"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"1.3214em"}},[s("span",{style:{top:"-2.314em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord"},[s("span",{class:"mord"},"0.1"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"+"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mord"},"0.1"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"+"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mord"},"0.8")])]),s("span",{style:{top:"-3.23em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"frac-line",style:{"border-bottom-width":"0.04em"}})]),s("span",{style:{top:"-3.677em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord"},[s("span",{class:"mord"},"0.1"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"+"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mord"},"0.8")])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.7693em"}},[s("span")])])])]),s("span",{class:"mclose nulldelimiter"})]),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6444em"}}),s("span",{class:"mord"},"0.6")])])])])],-1),N=l('<p><code>No</code>有更高的近似权重频率, 所以选择<code>No</code></p><figure><img src="'+g+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>数值变量<code>weight</code>字段, 我们使用权重平均值.</p><figure><img src="'+d+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="测试集中的缺失值" tabindex="-1"><a class="header-anchor" href="#测试集中的缺失值" aria-hidden="true">#</a> 测试集中的缺失值</h3><p>假设我们已经创建好随机森林, 来预测病人.</p><figure><img src="'+u+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>第一步, 我们复制该条记录, 并分别将目标属性赋值为<code>Yes</code>和<code>No</code> 第二步, 适用上面讲述的方法来补全缺失值</p><figure><img src="'+y+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="参考" tabindex="-1"><a class="header-anchor" href="#参考" aria-hidden="true">#</a> 参考</h2><p>https://www.youtube.com/watch?v=J4Wdy0Wc_xQ&amp;t=412s https://www.youtube.com/watch?v=sQ870aTKqiM</p>',11),Y=[_,x,b,v,w,k,N];function E(M,S){return t(),e("div",null,Y)}const B=n(f,[["render",E],["__file","3_1随机森林理论_缺失值处理.html.vue"]]);export{B as default};
