import{_ as t}from"./plugin-vue_export-helper-x3n3nnut.js";import{r as p,o as e,c as o,b as n,d as s,e as c,a as u}from"./app-9tftCahk.js";const i={},l=n("h1",{id:"目标编码-targetencoder",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#目标编码-targetencoder","aria-hidden":"true"},"#"),s(" 目标编码(TargetEncoder)")],-1),r=n("ol",null,[n("li",null,"对于分类目标的情况：特征被替换为给定特定分类值的目标后验概率和目标在所有训练数据上的先验概率的混合。"),n("li",null,"对于连续目标的情况：特征被替换为给定特定分类值的目标期望值和目标在所有训练数据上的期望值的混合。")],-1),k=n("h2",{id:"pandas",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#pandas","aria-hidden":"true"},"#"),s(" pandas")],-1),d={id:"category-encoders",tabindex:"-1"},m=n("a",{class:"header-anchor",href:"#category-encoders","aria-hidden":"true"},"#",-1),_={href:"https://contrib.scikit-learn.org/category_encoders/index.html",target:"_blank",rel:"noopener noreferrer"},g=u(`<div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>
<span class="token keyword">import</span> category_encoders <span class="token keyword">as</span> ce
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
data <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token string">&#39;Education&#39;</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">&#39;PhD&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;HighSchool&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;Bachelor&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;Master&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;HighSchool&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;Master&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;PhD&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;Bachelor&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">&#39;Income&#39;</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">28300</span><span class="token punctuation">,</span> <span class="token number">4500</span><span class="token punctuation">,</span> <span class="token number">7500</span><span class="token punctuation">,</span> <span class="token number">12500</span><span class="token punctuation">,</span> <span class="token number">4200</span><span class="token punctuation">,</span> <span class="token number">15000</span><span class="token punctuation">,</span> <span class="token number">25000</span><span class="token punctuation">,</span> <span class="token number">7200</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

Income_grand_mean <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">&#39;Income&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>
data<span class="token punctuation">[</span><span class="token string">&#39;Income_grand_mean&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>Income_grand_mean<span class="token punctuation">]</span><span class="token operator">*</span><span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
Income_group <span class="token operator">=</span> data<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&#39;Education&#39;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&#39;Income&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>rename<span class="token punctuation">(</span><span class="token string">&#39;Income_level_mean&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span><span class="token punctuation">)</span>
data_new <span class="token operator">=</span> pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>data<span class="token punctuation">,</span> Income_group<span class="token punctuation">)</span>
features <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>data_new<span class="token punctuation">.</span>columns<span class="token punctuation">)</span>
features<span class="token punctuation">.</span>remove<span class="token punctuation">(</span><span class="token string">&#39;Income&#39;</span><span class="token punctuation">)</span>

ce_11_1 <span class="token operator">=</span> ce<span class="token punctuation">.</span>TargetEncoder<span class="token punctuation">(</span>cols<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;Education&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> smoothing<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>data_new<span class="token punctuation">[</span>features<span class="token punctuation">]</span><span class="token punctuation">,</span> data_new<span class="token punctuation">[</span><span class="token string">&#39;Income&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
ce_11_2 <span class="token operator">=</span> ce<span class="token punctuation">.</span>TargetEncoder<span class="token punctuation">(</span>cols<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;Education&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> smoothing<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>data_new<span class="token punctuation">[</span>features<span class="token punctuation">]</span><span class="token punctuation">,</span> data_new<span class="token punctuation">[</span><span class="token string">&#39;Income&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
ce_11_3 <span class="token operator">=</span> ce<span class="token punctuation">.</span>TargetEncoder<span class="token punctuation">(</span>cols<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;Education&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> smoothing<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>data_new<span class="token punctuation">[</span>features<span class="token punctuation">]</span><span class="token punctuation">,</span> data_new<span class="token punctuation">[</span><span class="token string">&#39;Income&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>


</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="参考" tabindex="-1"><a class="header-anchor" href="#参考" aria-hidden="true">#</a> 参考</h2><ol><li>https://datascience.stackexchange.com/questions/39317/difference-between-ordinalencoder-and-labelencoder</li><li>https://www.cnblogs.com/dangui/p/15836197.html</li></ol>`,3);function h(v,b){const a=p("ExternalLinkIcon");return e(),o("div",null,[l,r,k,n("h2",d,[m,s(),n("a",_,[s("category_encoders"),c(a)])]),g])}const I=t(i,[["render",h],["__file","3_1_7特征编码_Target.html.vue"]]);export{I as default};
