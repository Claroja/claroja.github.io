import{_ as t}from"./plugin-vue_export-helper-x3n3nnut.js";import{r as e,o as l,c as p,a as s,b as a,d as c,e as i}from"./app-jdLxCr9I.js";const o={},m=s("h1",{id:"owe编码-woeencoder",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#owe编码-woeencoder","aria-hidden":"true"},"#"),a(" OWE编码(WOEEncoder)")],-1),r=s("p",null,"Leave One Out Encoder与Target Encoder非常相似，但在计算一个类别的平均目标时会排除当前行的目标，以减少异常值的影响。",-1),u=s("p",null,"如果您打算将编码用作预测模型的输入(例如，梯度增强)，则可能会出现问题。实际上，假设您使用TargetEncoder。这意味着您将在X_train中引入有关y_train的信息，这可能会导致严重的过度拟合风险。",-1),h=s("p",null,"关键是：如何在限制过度拟合风险的同时保持监督编码？LeaveOneOutEncoder提供了一个出色的解决方案。它执行原始目标编码，但是对于每一行，它不考虑对该行观察到的y值。这样，避免了行泄漏。",-1),g=s("p",null,"LeaveOneOutEncoder计算公式：",-1),d=s("p",{class:"katex-block"},[s("span",{class:"katex-display"},[s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[s("semantics",null,[s("mrow",null,[s("mi",null,"e"),s("mi",null,"n"),s("msub",null,[s("mi",null,"c"),s("mi",null,"i")]),s("mo",null,"="),s("mfrac",null,[s("mrow",null,[s("munder",null,[s("mo",null,"∑"),s("mrow",null,[s("mi",null,"j"),s("mo",{mathvariant:"normal"},"≠"),s("mi",null,"i")])]),s("mo",{stretchy:"false"},"("),s("msub",null,[s("mi",null,"y"),s("mi",null,"j")]),s("mo",null,"∗"),s("mo",{stretchy:"false"},"("),s("msub",null,[s("mi",null,"x"),s("mi",null,"j")]),s("mo",null,"="),s("mo",null,"="),s("mi",null,"k"),s("mo",{stretchy:"false"},")"),s("mo",{stretchy:"false"},")"),s("mo",null,"−"),s("msub",null,[s("mi",null,"y"),s("mi",null,"i")])]),s("mrow",null,[s("munder",null,[s("mo",null,"∑"),s("mrow",null,[s("mi",null,"j"),s("mo",{mathvariant:"normal"},"≠"),s("mi",null,"i")])]),s("msub",null,[s("mi",null,"x"),s("mi",null,"j")]),s("mo",null,"="),s("mo",null,"="),s("mi",null,"k")])])]),s("annotation",{encoding:"application/x-tex"}," enc_i=\\frac{\\sum_{j\\ne i}(y_j*(x_j==k))-y_i}{\\sum_{j\\ne i}x_j==k} ")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.5806em","vertical-align":"-0.15em"}}),s("span",{class:"mord mathnormal"},"e"),s("span",{class:"mord mathnormal"},"n"),s("span",{class:"mord"},[s("span",{class:"mord mathnormal"},"c"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3117em"}},[s("span",{style:{top:"-2.55em","margin-left":"0em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mathnormal mtight"},"i")])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.15em"}},[s("span")])])])])]),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"2.6976em","vertical-align":"-1.1218em"}}),s("span",{class:"mord"},[s("span",{class:"mopen nulldelimiter"}),s("span",{class:"mfrac"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"1.5758em"}},[s("span",{style:{top:"-2.314em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord"},[s("span",{class:"mop"},[s("span",{class:"mop op-symbol small-op",style:{position:"relative",top:"0em"}},"∑"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.1864em"}},[s("span",{style:{top:"-2.4003em","margin-left":"0em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.05724em"}},"j"),s("span",{class:"mrel mtight"},[s("span",{class:"mrel mtight"},[s("span",{class:"mord vbox mtight"},[s("span",{class:"thinbox mtight"},[s("span",{class:"rlap mtight"},[s("span",{class:"strut",style:{height:"0.8889em","vertical-align":"-0.1944em"}}),s("span",{class:"inner"},[s("span",{class:"mord mtight"},[s("span",{class:"mrel mtight"},"")])]),s("span",{class:"fix"})])])])]),s("span",{class:"mrel mtight"},"=")]),s("span",{class:"mord mathnormal mtight"},"i")])])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.4358em"}},[s("span")])])])])]),s("span",{class:"mspace",style:{"margin-right":"0.1667em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal"},"x"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3117em"}},[s("span",{style:{top:"-2.55em","margin-left":"0em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.05724em"}},"j")])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.2861em"}},[s("span")])])])])]),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"=="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.03148em"}},"k")])]),s("span",{style:{top:"-3.23em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"frac-line",style:{"border-bottom-width":"0.04em"}})]),s("span",{style:{top:"-3.8258em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord"},[s("span",{class:"mop"},[s("span",{class:"mop op-symbol small-op",style:{position:"relative",top:"0em"}},"∑"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.1864em"}},[s("span",{style:{top:"-2.4003em","margin-left":"0em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.05724em"}},"j"),s("span",{class:"mrel mtight"},[s("span",{class:"mrel mtight"},[s("span",{class:"mord vbox mtight"},[s("span",{class:"thinbox mtight"},[s("span",{class:"rlap mtight"},[s("span",{class:"strut",style:{height:"0.8889em","vertical-align":"-0.1944em"}}),s("span",{class:"inner"},[s("span",{class:"mord mtight"},[s("span",{class:"mrel mtight"},"")])]),s("span",{class:"fix"})])])])]),s("span",{class:"mrel mtight"},"=")]),s("span",{class:"mord mathnormal mtight"},"i")])])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.4358em"}},[s("span")])])])])]),s("span",{class:"mopen"},"("),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"y"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3117em"}},[s("span",{style:{top:"-2.55em","margin-left":"-0.0359em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.05724em"}},"j")])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.2861em"}},[s("span")])])])])]),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"∗"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mopen"},"("),s("span",{class:"mord"},[s("span",{class:"mord mathnormal"},"x"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3117em"}},[s("span",{style:{top:"-2.55em","margin-left":"0em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.05724em"}},"j")])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.2861em"}},[s("span")])])])])]),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"=="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.03148em"}},"k"),s("span",{class:"mclose"},"))"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"−"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"y"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3117em"}},[s("span",{style:{top:"-2.55em","margin-left":"-0.0359em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mathnormal mtight"},"i")])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.15em"}},[s("span")])])])])])])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"1.1218em"}},[s("span")])])])]),s("span",{class:"mclose nulldelimiter"})])])])])])],-1),k=s("h2",{id:"pandas",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#pandas","aria-hidden":"true"},"#"),a(" pandas")],-1),v={id:"category-encoders",tabindex:"-1"},y=s("a",{class:"header-anchor",href:"#category-encoders","aria-hidden":"true"},"#",-1),_={href:"https://contrib.scikit-learn.org/category_encoders/index.html",target:"_blank",rel:"noopener noreferrer"},b=i(`<div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">import</span> category_encoders <span class="token keyword">as</span> ce
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
data <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token string">&#39;Education&#39;</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">&#39;PhD&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;HighSchool&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;Bachelor&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;Master&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;HighSchool&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;Master&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;PhD&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;Bachelor&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">&#39;Income&#39;</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">28300</span><span class="token punctuation">,</span> <span class="token number">4500</span><span class="token punctuation">,</span> <span class="token number">7500</span><span class="token punctuation">,</span> <span class="token number">12500</span><span class="token punctuation">,</span> <span class="token number">4200</span><span class="token punctuation">,</span> <span class="token number">15000</span><span class="token punctuation">,</span> <span class="token number">25000</span><span class="token punctuation">,</span> <span class="token number">7200</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

Income_grand_mean <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">&#39;Income&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>
data<span class="token punctuation">[</span><span class="token string">&#39;Income_grand_mean&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>Income_grand_mean<span class="token punctuation">]</span><span class="token operator">*</span><span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
Income_group <span class="token operator">=</span> data<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&#39;Education&#39;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&#39;Income&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>rename<span class="token punctuation">(</span><span class="token string">&#39;Income_level_mean&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span><span class="token punctuation">)</span>
data_new <span class="token operator">=</span> pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>data<span class="token punctuation">,</span> Income_group<span class="token punctuation">)</span>
features <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>data_new<span class="token punctuation">.</span>columns<span class="token punctuation">)</span>
features<span class="token punctuation">.</span>remove<span class="token punctuation">(</span><span class="token string">&#39;Income&#39;</span><span class="token punctuation">)</span>
ce_16 <span class="token operator">=</span> ce<span class="token punctuation">.</span>LeaveOneOutEncoder<span class="token punctuation">(</span>cols<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;Education&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>data_new<span class="token punctuation">[</span>features<span class="token punctuation">]</span><span class="token punctuation">,</span> data_new<span class="token punctuation">[</span><span class="token string">&#39;Income&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="参考" tabindex="-1"><a class="header-anchor" href="#参考" aria-hidden="true">#</a> 参考</h2><ol><li>https://datascience.stackexchange.com/questions/39317/difference-between-ordinalencoder-and-labelencoder</li><li>https://www.cnblogs.com/dangui/p/15836197.html</li></ol>`,3);function f(x,w){const n=e("ExternalLinkIcon");return l(),p("div",null,[m,r,u,h,g,d,k,s("h2",v,[y,a(),s("a",_,[a("category_encoders"),c(n)])]),b])}const E=t(o,[["render",f],["__file","3_1_8特征编码_LeaveOneOut.html.vue"]]);export{E as default};
