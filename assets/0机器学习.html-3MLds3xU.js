import{_ as n}from"./plugin-vue_export-helper-x3n3nnut.js";import{o as s,c as a,a as t}from"./app-9tftCahk.js";const p={},o=t(`<p>数据科学包含了3部分:</p><ol><li>mathematics (i.e. statistics, linear algebra, etc.)</li><li>computer science (i.e. programming languages, computer systems, etc.)</li><li>business management (i.e. communication, subject-matter knowledge, etc.)</li></ol><p>没有最好的机器学习算法(Machine Learning Algorithm), 只有最适合某个情形, 某个数据集的算法. 选择最优算法的最好方法就是试验所有的MLA, 调试, 挑选最好的MLA.</p><p>在没有任何信息情况下, 二类问题的基础模型准确性设定为50%. 而在有目标统计占比的情况下, 二分类问题的基础模型准确性设定为该比例.</p><h1 id="一般流程" tabindex="-1"><a class="header-anchor" href="#一般流程" aria-hidden="true">#</a> 一般流程</h1><h2 id="数据挖掘流程" tabindex="-1"><a class="header-anchor" href="#数据挖掘流程" aria-hidden="true">#</a> 数据挖掘流程</h2><ol><li>数据探索: 主要为后面的步骤做铺垫</li><li>特征工程</li><li>模型构建 <ol><li>数据编码</li><li>模型构建</li><li>模型训练 <ol><li>特征选择</li><li>模型选择</li><li>参数选择</li></ol></li></ol></li><li>模型部署</li></ol><h2 id="案例" tabindex="-1"><a class="header-anchor" href="#案例" aria-hidden="true">#</a> 案例</h2><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> StandardScaler
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>linear_model <span class="token keyword">import</span> LogisticRegression
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> roc_curve<span class="token punctuation">,</span> roc_auc_score
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt


<span class="token comment">## ETL</span>

<span class="token comment">### 数据提取(extract)</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&quot;./Credit.csv&quot;</span><span class="token punctuation">)</span>


<span class="token comment">### 数据转换(transform)</span>

<span class="token comment">#### 删除不需要的列</span>
df <span class="token operator">=</span> df<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;ID&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>

<span class="token comment">#### 填补缺失值(这里的处理不够严谨, 只考虑了连续变量, 没有考虑分类变量的情况)</span>
<span class="token keyword">for</span> column <span class="token keyword">in</span> <span class="token builtin">list</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>columns<span class="token punctuation">[</span>df<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    mean_val <span class="token operator">=</span> df<span class="token punctuation">[</span>column<span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>
    df<span class="token punctuation">[</span>column<span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>mean_val<span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    
<span class="token comment">#### 连续变量进行归一化</span>
scaler <span class="token operator">=</span> StandardScaler<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fit<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;A&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;B&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
df<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;A&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;B&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> scaler<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;A&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;B&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>


<span class="token comment">#### 分类变量one-hot编码</span>
dummies <span class="token operator">=</span> pd<span class="token punctuation">.</span>get_dummies<span class="token punctuation">(</span>df<span class="token punctuation">)</span>

<span class="token comment">### 数据加载(load)</span>

<span class="token comment">#### 分割自变量和因变量</span>
X <span class="token operator">=</span> dummies<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> dummies<span class="token punctuation">.</span>columns <span class="token operator">!=</span> <span class="token string">&#39;Label&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values
y <span class="token operator">=</span> dummies<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> dummies<span class="token punctuation">.</span>columns <span class="token operator">==</span> <span class="token string">&#39;Label&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values
<span class="token comment">#### 分割测试集和训练集</span>
X_train<span class="token punctuation">,</span> X_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">,</span>train_size<span class="token operator">=</span><span class="token number">0.8</span><span class="token punctuation">,</span>random_state<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span>stratify<span class="token operator">=</span>y<span class="token punctuation">)</span>


<span class="token comment">## 构建模型并训练</span>

LR <span class="token operator">=</span> LogisticRegression<span class="token punctuation">(</span><span class="token punctuation">)</span>
LR<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span>y_train<span class="token punctuation">)</span>


<span class="token comment">## 评估模型</span>

<span class="token comment">### 预测, 这里取正值的概率(即label=1)</span>
y_pred_proba <span class="token operator">=</span> LR<span class="token punctuation">.</span>predict_proba<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span>



<span class="token comment">### 绘制ROC曲线, 计算AUC</span>
fpr<span class="token punctuation">,</span> tpr<span class="token punctuation">,</span> thresholds <span class="token operator">=</span> roc_curve<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_pred_proba<span class="token punctuation">)</span>
auc_score <span class="token operator">=</span> roc_auc_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_pred_proba<span class="token punctuation">)</span>


plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>fpr<span class="token punctuation">,</span> tpr<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f&#39;AUC = </span><span class="token interpolation"><span class="token punctuation">{</span>auc_score<span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string">&#39;</span></span><span class="token punctuation">)</span>  <span class="token comment"># 绘制ROC曲线，标注AUC的值</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> linestyle<span class="token operator">=</span><span class="token string">&#39;--&#39;</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">&#39;r&#39;</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">&#39;Random Classifier&#39;</span><span class="token punctuation">)</span>  <span class="token comment"># 绘制随机分类器的ROC曲线</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">&#39;False Positive Rate&#39;</span><span class="token punctuation">)</span>  <span class="token comment"># x轴标签为FPR</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">&#39;True Positive Rate&#39;</span><span class="token punctuation">)</span>   <span class="token comment"># y轴标签为TPR</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">&#39;ROC Curve&#39;</span><span class="token punctuation">)</span>             <span class="token comment"># 设置标题</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">### 绘制KS曲线</span>
ks_arg <span class="token operator">=</span> <span class="token punctuation">(</span>tpr <span class="token operator">-</span> fpr<span class="token punctuation">)</span><span class="token punctuation">.</span>argmax<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 取最大值的下标</span>
ks_value <span class="token operator">=</span> <span class="token builtin">max</span><span class="token punctuation">(</span>tpr <span class="token operator">-</span> fpr<span class="token punctuation">)</span>  <span class="token comment"># 取最大值</span>
threshold <span class="token operator">=</span> thresholds<span class="token punctuation">[</span>ks_arg<span class="token punctuation">]</span> <span class="token comment"># 取阈值</span>

tpr_value <span class="token operator">=</span> tpr<span class="token punctuation">[</span>ks_arg<span class="token punctuation">]</span> <span class="token comment"># tpr值</span>
fpr_value <span class="token operator">=</span> fpr<span class="token punctuation">[</span>ks_arg<span class="token punctuation">]</span> <span class="token comment"># fpr值</span>

plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>thresholds<span class="token punctuation">,</span> fpr<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f&#39;fpr&#39;</span></span><span class="token punctuation">)</span>  <span class="token comment"># 绘制ROC曲线，标注AUC的值</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>thresholds<span class="token punctuation">,</span> tpr<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f&#39;tpr&#39;</span></span><span class="token punctuation">)</span>  <span class="token comment"># 绘制ROC曲线，标注AUC的值</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">[</span>thresholds<span class="token punctuation">[</span>ks_arg<span class="token punctuation">]</span><span class="token punctuation">,</span>thresholds<span class="token punctuation">[</span>ks_arg<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span>tpr<span class="token punctuation">[</span>ks_arg<span class="token punctuation">]</span><span class="token punctuation">,</span>fpr<span class="token punctuation">[</span>ks_arg<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f&#39;ks&#39;</span></span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">&#39;thresholds&#39;</span><span class="token punctuation">)</span>  <span class="token comment"># x轴标签为FPR</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">&#39;tpr&amp;fpr&#39;</span><span class="token punctuation">)</span>   <span class="token comment"># y轴标签为TPR</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">&#39;KS Curve&#39;</span><span class="token punctuation">)</span>   <span class="token comment"># 设置标题</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,9),e=[o];function c(l,i){return s(),a("div",null,e)}const k=n(p,[["render",c],["__file","0机器学习.html.vue"]]);export{k as default};
