import{_ as n}from"./plugin-vue_export-helper-x3n3nnut.js";import{o as s,c as a,e as t}from"./app-qxiCM96p.js";const p={},o=t(`<h1 id="json" tabindex="-1"><a class="header-anchor" href="#json" aria-hidden="true">#</a> json</h1><h2 id="type" tabindex="-1"><a class="header-anchor" href="#type" aria-hidden="true">#</a> type</h2><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> JSON_TYPE<span class="token punctuation">(</span><span class="token string">&#39;[&quot;a&quot;, &quot;b&quot;, 1]&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> JSON_TYPE<span class="token punctuation">(</span><span class="token string">&#39;{&quot;k1&quot;: &quot;value&quot;, &quot;k2&quot;: 10}&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code>mysql<span class="token operator">&gt;</span> <span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> t1 <span class="token punctuation">(</span>c1 JSON<span class="token punctuation">)</span><span class="token punctuation">;</span>

mysql<span class="token operator">&gt;</span> <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> t1 <span class="token keyword">VALUES</span>
     <span class="token operator">&gt;</span>     <span class="token punctuation">(</span><span class="token string">&#39;{&quot;x&quot;: 17, &quot;x&quot;: &quot;red&quot;}&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
     <span class="token operator">&gt;</span>     <span class="token punctuation">(</span><span class="token string">&#39;{&quot;x&quot;: 17, &quot;x&quot;: &quot;red&quot;, &quot;x&quot;: [3, 5, 7]}&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

mysql<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> c1 <span class="token keyword">FROM</span> t1<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="function" tabindex="-1"><a class="header-anchor" href="#function" aria-hidden="true">#</a> function</h2><h3 id="search" tabindex="-1"><a class="header-anchor" href="#search" aria-hidden="true">#</a> search</h3><p><code>SET @var_name = expr [, @var_name = expr]</code><code>set @j</code>就是对@j进行赋值 <code>$</code>符是当前json对象的意思</p><table><thead><tr><th>方法</th><th>描述</th></tr></thead><tbody><tr><td><code>JSON_CONTAINS(target, candidate[, path])</code></td><td></td></tr><tr><td><code>JSON_CONTAINS_PATH(json_doc, one_or_all, path[, path] ...)</code></td><td></td></tr><tr><td><code>JSON_EXTRACT(json_doc, path[, path] ...)</code></td><td></td></tr><tr><td><code>JSON_KEYS(json_doc[, path])</code></td><td></td></tr><tr><td><code>JSON_OVERLAPS(json_doc1, json_doc2)</code></td><td></td></tr><tr><td><code>JSON_SEARCH(json_doc, one_or_all, search_str[, escape_char[, path] ...])</code></td><td></td></tr><tr><td><code>alue MEMBER OF(json_array)</code></td><td></td></tr></tbody></table><p>1<code>JSON_CONTAINS(target, candidate[, path])</code> 判断target的key 的value 是否为candidate</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SET</span> <span class="token variable">@j</span> <span class="token operator">=</span> <span class="token string">&#39;{&quot;a&quot;: 1, &quot;b&quot;: 2, &quot;c&quot;: {&quot;d&quot;: 4}}&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">SET</span> <span class="token variable">@j2</span> <span class="token operator">=</span> <span class="token string">&#39;1&#39;</span><span class="token punctuation">;</span> <span class="token comment">--用来测试包含字符</span>
<span class="token keyword">SELECT</span> JSON_CONTAINS<span class="token punctuation">(</span><span class="token variable">@j</span><span class="token punctuation">,</span> <span class="token variable">@j2</span><span class="token punctuation">,</span> <span class="token string">&#39;$.a&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- 1 //@j中键a,包含@j2</span>
<span class="token keyword">SELECT</span> JSON_CONTAINS<span class="token punctuation">(</span><span class="token variable">@j</span><span class="token punctuation">,</span> <span class="token variable">@j2</span><span class="token punctuation">,</span> <span class="token string">&#39;$.b&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- 0 //@j中键B,不包含@j2</span>

<span class="token keyword">SET</span> <span class="token variable">@j2</span> <span class="token operator">=</span> <span class="token string">&#39;{&quot;d&quot;: 4}&#39;</span><span class="token punctuation">;</span> <span class="token comment">-- 用来验证包含字典结构</span>
<span class="token keyword">SELECT</span> JSON_CONTAINS<span class="token punctuation">(</span><span class="token variable">@j</span><span class="token punctuation">,</span> <span class="token variable">@j2</span><span class="token punctuation">,</span> <span class="token string">&#39;$.a&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- 0 //@j中键a,包含@j2</span>
<span class="token keyword">SELECT</span> JSON_CONTAINS<span class="token punctuation">(</span><span class="token variable">@j</span><span class="token punctuation">,</span> <span class="token variable">@j2</span><span class="token punctuation">,</span> <span class="token string">&#39;$.c&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- 1 //@j中键B,不包含@j2</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>2.<code>JSON_CONTAINS_PATH(json_doc, one_or_all, path[, path] ...)</code> 判断json_doc是否包含指定节点</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SET</span> <span class="token variable">@j</span> <span class="token operator">=</span> <span class="token string">&#39;{&quot;a&quot;: 1, &quot;b&quot;: 2, &quot;c&quot;: {&quot;d&quot;: 4}}&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> JSON_CONTAINS_PATH<span class="token punctuation">(</span><span class="token variable">@j</span><span class="token punctuation">,</span> <span class="token string">&#39;one&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;$.a&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;$.e&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- 1 //</span>
<span class="token keyword">SELECT</span> JSON_CONTAINS_PATH<span class="token punctuation">(</span><span class="token variable">@j</span><span class="token punctuation">,</span> <span class="token string">&#39;all&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;$.a&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;$.e&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- 0</span>
<span class="token keyword">SELECT</span> JSON_CONTAINS_PATH<span class="token punctuation">(</span><span class="token variable">@j</span><span class="token punctuation">,</span> <span class="token string">&#39;one&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;$.c.d&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- 1</span>
<span class="token keyword">SELECT</span> JSON_CONTAINS_PATH<span class="token punctuation">(</span><span class="token variable">@j</span><span class="token punctuation">,</span> <span class="token string">&#39;one&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;$.a.d&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- 0</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>3.<code>JSON_EXTRACT(json_doc, path[, path] ...)</code> 取json的某个位置上的元素</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> JSON_EXTRACT<span class="token punctuation">(</span><span class="token string">&#39;[10, 20, [30, 40]]&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;$[1]&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- 20</span>
<span class="token keyword">SELECT</span> JSON_EXTRACT<span class="token punctuation">(</span><span class="token string">&#39;[10, 20, [30, 40]]&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;$[1]&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;$[0]&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- [20, 10]</span>
<span class="token keyword">SELECT</span> JSON_EXTRACT<span class="token punctuation">(</span><span class="token string">&#39;[10, 20, [30, 40]]&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;$[2][*]&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- [30, 40]    </span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>-&gt;</code>是<code>JSON_EXTRACT</code>的简写</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code>mysql<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> c<span class="token punctuation">,</span> JSON_EXTRACT<span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token string">&quot;$.id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> g
     <span class="token operator">&gt;</span> <span class="token keyword">FROM</span> jemp
     <span class="token operator">&gt;</span> <span class="token keyword">WHERE</span> JSON_EXTRACT<span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token string">&quot;$.id&quot;</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">1</span>
     <span class="token operator">&gt;</span> <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> JSON_EXTRACT<span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token string">&quot;$.name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">-------------------------------+-----------+------+</span>
<span class="token operator">|</span> c                             <span class="token operator">|</span> c<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token string">&quot;$.id&quot;</span> <span class="token operator">|</span> g    <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------------------------------+-----------+------+</span>
<span class="token operator">|</span> {<span class="token string">&quot;id&quot;</span>: <span class="token string">&quot;3&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;name&quot;</span>: <span class="token string">&quot;Barney&quot;</span>} <span class="token operator">|</span> <span class="token string">&quot;3&quot;</span>       <span class="token operator">|</span>    <span class="token number">3</span> <span class="token operator">|</span>
<span class="token operator">|</span> {<span class="token string">&quot;id&quot;</span>: <span class="token string">&quot;4&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;name&quot;</span>: <span class="token string">&quot;Betty&quot;</span>}  <span class="token operator">|</span> <span class="token string">&quot;4&quot;</span>       <span class="token operator">|</span>    <span class="token number">4</span> <span class="token operator">|</span>
<span class="token operator">|</span> {<span class="token string">&quot;id&quot;</span>: <span class="token string">&quot;2&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;name&quot;</span>: <span class="token string">&quot;Wilma&quot;</span>}  <span class="token operator">|</span> <span class="token string">&quot;2&quot;</span>       <span class="token operator">|</span>    <span class="token number">2</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------------------------------+-----------+------+</span>
<span class="token number">3</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> c<span class="token punctuation">,</span> c<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token string">&quot;$.id&quot;</span><span class="token punctuation">,</span> g
     <span class="token operator">&gt;</span> <span class="token keyword">FROM</span> jemp
     <span class="token operator">&gt;</span> <span class="token keyword">WHERE</span> c<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token string">&quot;$.id&quot;</span> <span class="token operator">&gt;</span> <span class="token number">1</span>
     <span class="token operator">&gt;</span> <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> c<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token string">&quot;$.name&quot;</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">-------------------------------+-----------+------+</span>
<span class="token operator">|</span> c                             <span class="token operator">|</span> c<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token string">&quot;$.id&quot;</span> <span class="token operator">|</span> g    <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------------------------------+-----------+------+</span>
<span class="token operator">|</span> {<span class="token string">&quot;id&quot;</span>: <span class="token string">&quot;3&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;name&quot;</span>: <span class="token string">&quot;Barney&quot;</span>} <span class="token operator">|</span> <span class="token string">&quot;3&quot;</span>       <span class="token operator">|</span>    <span class="token number">3</span> <span class="token operator">|</span>
<span class="token operator">|</span> {<span class="token string">&quot;id&quot;</span>: <span class="token string">&quot;4&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;name&quot;</span>: <span class="token string">&quot;Betty&quot;</span>}  <span class="token operator">|</span> <span class="token string">&quot;4&quot;</span>       <span class="token operator">|</span>    <span class="token number">4</span> <span class="token operator">|</span>
<span class="token operator">|</span> {<span class="token string">&quot;id&quot;</span>: <span class="token string">&quot;2&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;name&quot;</span>: <span class="token string">&quot;Wilma&quot;</span>}  <span class="token operator">|</span> <span class="token string">&quot;2&quot;</span>       <span class="token operator">|</span>    <span class="token number">2</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------------------------------+-----------+------+</span>
<span class="token number">3</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>column-&gt;&gt;path</code></p><p>此三个函数是等价的</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code>JSON_UNQUOTE<span class="token punctuation">(</span> JSON_EXTRACT<span class="token punctuation">(</span><span class="token keyword">column</span><span class="token punctuation">,</span> path<span class="token punctuation">)</span> <span class="token punctuation">)</span>
JSON_UNQUOTE<span class="token punctuation">(</span><span class="token keyword">column</span> <span class="token operator">-</span><span class="token operator">&gt;</span> path<span class="token punctuation">)</span>
<span class="token keyword">column</span><span class="token operator">-</span><span class="token operator">&gt;&gt;</span>path
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>4.<code>JSON_KEYS(json_doc[, path])</code></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> JSON_KEYS<span class="token punctuation">(</span><span class="token string">&#39;{&quot;a&quot;: 1, &quot;b&quot;: {&quot;c&quot;: 30}}&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">--  [&quot;a&quot;, &quot;b&quot;]    </span>
<span class="token keyword">SELECT</span> JSON_KEYS<span class="token punctuation">(</span><span class="token string">&#39;{&quot;a&quot;: 1, &quot;b&quot;: {&quot;c&quot;: 30}}&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;$.b&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- [&quot;c&quot;]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>5.<code>JSON_OVERLAPS(json_doc1, json_doc2)</code> 两个json中是否有相容的元素</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> JSON_OVERLAPS<span class="token punctuation">(</span><span class="token string">&quot;[1,3,5,7]&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;[2,5,7]&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">-- 1</span>
<span class="token keyword">SELECT</span> JSON_OVERLAPS<span class="token punctuation">(</span><span class="token string">&quot;[1,3,5,7]&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;[2,6,7]&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">-- 1</span>
<span class="token keyword">SELECT</span> JSON_OVERLAPS<span class="token punctuation">(</span><span class="token string">&quot;[1,3,5,7]&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;[2,6,8]&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">-- 0</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>6.<code>JSON_SEARCH(json_doc, one_or_all, search_str[, escape_char[, path] ...])</code> 查询指定值的位置</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SET</span> <span class="token variable">@j</span> <span class="token operator">=</span> <span class="token string">&#39;[&quot;abc&quot;, [{&quot;k&quot;: &quot;10&quot;}, &quot;def&quot;], {&quot;x&quot;:&quot;abc&quot;}, {&quot;y&quot;:&quot;bcd&quot;}]&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> JSON_SEARCH<span class="token punctuation">(</span><span class="token variable">@j</span><span class="token punctuation">,</span> <span class="token string">&#39;one&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;abc&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">-- &quot;$[0]&quot;</span>
<span class="token keyword">SELECT</span> JSON_SEARCH<span class="token punctuation">(</span><span class="token variable">@j</span><span class="token punctuation">,</span> <span class="token string">&#39;all&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;abc&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">-- [&quot;$[0]&quot;, &quot;$[2].x&quot;]</span>
<span class="token keyword">SELECT</span> JSON_SEARCH<span class="token punctuation">(</span><span class="token variable">@j</span><span class="token punctuation">,</span> <span class="token string">&#39;all&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;ghi&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">-- NULL</span>
<span class="token keyword">SELECT</span> JSON_SEARCH<span class="token punctuation">(</span><span class="token variable">@j</span><span class="token punctuation">,</span> <span class="token string">&#39;all&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;10&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">-- &quot;$[1][0].k&quot;</span>
<span class="token keyword">SELECT</span> JSON_SEARCH<span class="token punctuation">(</span><span class="token variable">@j</span><span class="token punctuation">,</span> <span class="token string">&#39;all&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;10&#39;</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">&#39;$&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- &quot;$[1][0].k&quot;</span>
<span class="token keyword">SELECT</span> JSON_SEARCH<span class="token punctuation">(</span><span class="token variable">@j</span><span class="token punctuation">,</span> <span class="token string">&#39;all&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;10&#39;</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">&#39;$[*]&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- &quot;$[1][0].k&quot;</span>
<span class="token keyword">SELECT</span> JSON_SEARCH<span class="token punctuation">(</span><span class="token variable">@j</span><span class="token punctuation">,</span> <span class="token string">&#39;all&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;10&#39;</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">&#39;$**.k&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- &quot;$[1][0].k&quot;</span>
<span class="token keyword">SELECT</span> JSON_SEARCH<span class="token punctuation">(</span><span class="token variable">@j</span><span class="token punctuation">,</span> <span class="token string">&#39;all&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;10&#39;</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">&#39;$[*][0].k&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- &quot;$[1][0].k&quot;</span>
<span class="token keyword">SELECT</span> JSON_SEARCH<span class="token punctuation">(</span><span class="token variable">@j</span><span class="token punctuation">,</span> <span class="token string">&#39;all&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;10&#39;</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">&#39;$[1]&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- &quot;$[1][0].k&quot;</span>
<span class="token keyword">SELECT</span> JSON_SEARCH<span class="token punctuation">(</span><span class="token variable">@j</span><span class="token punctuation">,</span> <span class="token string">&#39;all&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;10&#39;</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">&#39;$[1][0]&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- &quot;$[1][0].k&quot;</span>
<span class="token keyword">SELECT</span> JSON_SEARCH<span class="token punctuation">(</span><span class="token variable">@j</span><span class="token punctuation">,</span> <span class="token string">&#39;all&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;abc&#39;</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">&#39;$[2]&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- &quot;$[2].x&quot;</span>
<span class="token keyword">SELECT</span> JSON_SEARCH<span class="token punctuation">(</span><span class="token variable">@j</span><span class="token punctuation">,</span> <span class="token string">&#39;all&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;%a%&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- [&quot;$[0]&quot;, &quot;$[2].x&quot;]</span>
<span class="token keyword">SELECT</span> JSON_SEARCH<span class="token punctuation">(</span><span class="token variable">@j</span><span class="token punctuation">,</span> <span class="token string">&#39;all&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;%b%&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- [&quot;$[0]&quot;, &quot;$[2].x&quot;, &quot;$[3].y&quot;]</span>
<span class="token keyword">SELECT</span> JSON_SEARCH<span class="token punctuation">(</span><span class="token variable">@j</span><span class="token punctuation">,</span> <span class="token string">&#39;all&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;%b%&#39;</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">&#39;$[0]&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- &quot;$[0]&quot;</span>
<span class="token keyword">SELECT</span> JSON_SEARCH<span class="token punctuation">(</span><span class="token variable">@j</span><span class="token punctuation">,</span> <span class="token string">&#39;all&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;%b%&#39;</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">&#39;$[2]&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- &quot;$[2].x&quot;</span>
<span class="token keyword">SELECT</span> JSON_SEARCH<span class="token punctuation">(</span><span class="token variable">@j</span><span class="token punctuation">,</span> <span class="token string">&#39;all&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;%b%&#39;</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">&#39;$[1]&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">-- NULL</span>
<span class="token keyword">SELECT</span> JSON_SEARCH<span class="token punctuation">(</span><span class="token variable">@j</span><span class="token punctuation">,</span> <span class="token string">&#39;all&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;%b%&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;$[1]&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">-- NULL</span>
<span class="token keyword">SELECT</span> JSON_SEARCH<span class="token punctuation">(</span><span class="token variable">@j</span><span class="token punctuation">,</span> <span class="token string">&#39;all&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;%b%&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;$[3]&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">-- &quot;$[3].y&quot;</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>7.<code>alue MEMBER OF(json_array)</code> 查询一个值是否在json列表</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token number">17</span> MEMBER <span class="token keyword">OF</span><span class="token punctuation">(</span><span class="token string">&#39;[23, &quot;abc&quot;, 17, &quot;ab&quot;, 10]&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- 1</span>
<span class="token keyword">SELECT</span> <span class="token number">7</span> MEMBER <span class="token keyword">OF</span><span class="token punctuation">(</span><span class="token string">&#39;[23, &quot;abc&quot;, 17, &quot;ab&quot;, 10]&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- 0</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="modify" tabindex="-1"><a class="header-anchor" href="#modify" aria-hidden="true">#</a> modify</h3><table><thead><tr><th>方法</th><th>描述</th></tr></thead><tbody><tr><td><code>JSON_ARRAY_APPEND(json_doc, path, val[, path, val] ...)</code></td><td></td></tr><tr><td><code>JSON_ARRAY_INSERT(json_doc, path, val[, path, val] ...)</code></td><td></td></tr><tr><td><code>JSON_INSERT(json_doc, path, val[, path, val] ...)</code></td><td></td></tr><tr><td><code>JSON_MERGE(json_doc, json_doc[, json_doc] ...)</code></td><td></td></tr><tr><td><code>JSON_MERGE_PATCH(json_doc, json_doc[, json_doc] ...)</code></td><td></td></tr><tr><td><code>JSON_MERGE_PRESERVE(json_doc, json_doc[, json_doc] ...)</code></td><td></td></tr><tr><td><code>JSON_REMOVE(json_doc, path[, path] ...)</code></td><td></td></tr><tr><td><code>JSON_REPLACE(json_doc, path, val[, path, val] ...)</code></td><td></td></tr><tr><td><code>JSON_SET(json_doc, path, val[, path, val] ...)</code></td><td></td></tr><tr><td><code>JSON_UNQUOTE(json_val)</code></td><td></td></tr></tbody></table><p>1.<code>JSON_ARRAY_APPEND(json_doc, path, val[, path, val] ...)</code></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SET</span> <span class="token variable">@j</span> <span class="token operator">=</span> <span class="token string">&#39;[&quot;a&quot;, [&quot;b&quot;, &quot;c&quot;], &quot;d&quot;]&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> JSON_ARRAY_APPEND<span class="token punctuation">(</span><span class="token variable">@j</span><span class="token punctuation">,</span> <span class="token string">&#39;$[1]&#39;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- [&quot;a&quot;, [&quot;b&quot;, &quot;c&quot;, 1], &quot;d&quot;];</span>
<span class="token keyword">SELECT</span> JSON_ARRAY_APPEND<span class="token punctuation">(</span><span class="token variable">@j</span><span class="token punctuation">,</span> <span class="token string">&#39;$[0]&#39;</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- [[&quot;a&quot;, 2], [&quot;b&quot;, &quot;c&quot;], &quot;d&quot;]</span>
<span class="token keyword">SELECT</span> JSON_ARRAY_APPEND<span class="token punctuation">(</span><span class="token variable">@j</span><span class="token punctuation">,</span> <span class="token string">&#39;$[1][0]&#39;</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- [&quot;a&quot;, [[&quot;b&quot;, 3], &quot;c&quot;], &quot;d&quot;]</span>

<span class="token keyword">SET</span> <span class="token variable">@j</span> <span class="token operator">=</span> <span class="token string">&#39;{&quot;a&quot;: 1, &quot;b&quot;: [2, 3], &quot;c&quot;: 4}&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> JSON_ARRAY_APPEND<span class="token punctuation">(</span><span class="token variable">@j</span><span class="token punctuation">,</span> <span class="token string">&#39;$.b&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;x&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- {&quot;a&quot;: 1, &quot;b&quot;: [2, 3, &quot;x&quot;], &quot;c&quot;: 4}</span>
<span class="token keyword">SELECT</span> JSON_ARRAY_APPEND<span class="token punctuation">(</span><span class="token variable">@j</span><span class="token punctuation">,</span> <span class="token string">&#39;$.c&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;y&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- {&quot;a&quot;: 1, &quot;b&quot;: [2, 3], &quot;c&quot;: [4, &quot;y&quot;]}</span>

<span class="token keyword">SET</span> <span class="token variable">@j</span> <span class="token operator">=</span> <span class="token string">&#39;{&quot;a&quot;: 1}&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> JSON_ARRAY_APPEND<span class="token punctuation">(</span><span class="token variable">@j</span><span class="token punctuation">,</span> <span class="token string">&#39;$&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;z&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- [{&quot;a&quot;: 1}, &quot;z&quot;]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>2.<code>JSON_ARRAY_INSERT(json_doc, path, val[, path, val] ...)</code></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SET</span> <span class="token variable">@j</span> <span class="token operator">=</span> <span class="token string">&#39;[&quot;a&quot;, {&quot;b&quot;: [1, 2]}, [3, 4]]&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> JSON_ARRAY_INSERT<span class="token punctuation">(</span><span class="token variable">@j</span><span class="token punctuation">,</span> <span class="token string">&#39;$[1]&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;x&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- [&quot;a&quot;, &quot;x&quot;, {&quot;b&quot;: [1, 2]}, [3, 4]]</span>
<span class="token keyword">SELECT</span> JSON_ARRAY_INSERT<span class="token punctuation">(</span><span class="token variable">@j</span><span class="token punctuation">,</span> <span class="token string">&#39;$[100]&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;x&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- [&quot;a&quot;, {&quot;b&quot;: [1, 2]}, [3, 4], &quot;x&quot;]</span>
<span class="token keyword">SELECT</span> JSON_ARRAY_INSERT<span class="token punctuation">(</span><span class="token variable">@j</span><span class="token punctuation">,</span> <span class="token string">&#39;$[1].b[0]&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;x&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- [&quot;a&quot;, {&quot;b&quot;: [&quot;x&quot;, 1, 2]}, [3, 4]]</span>
<span class="token keyword">SELECT</span> JSON_ARRAY_INSERT<span class="token punctuation">(</span><span class="token variable">@j</span><span class="token punctuation">,</span> <span class="token string">&#39;$[2][1]&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;y&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- [&quot;a&quot;, {&quot;b&quot;: [1, 2]}, [3, &quot;y&quot;, 4]]</span>
<span class="token keyword">SELECT</span> JSON_ARRAY_INSERT<span class="token punctuation">(</span><span class="token variable">@j</span><span class="token punctuation">,</span> <span class="token string">&#39;$[0]&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;x&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;$[2][1]&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;y&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- [&quot;x&quot;, &quot;a&quot;, {&quot;b&quot;: [1, 2]}, [3, 4]]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>3.<code>JSON_INSERT(json_doc, path, val[, path, val] ...)</code></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SET</span> <span class="token variable">@j</span> <span class="token operator">=</span> <span class="token string">&#39;{ &quot;a&quot;: 1, &quot;b&quot;: [2, 3]}&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> JSON_INSERT<span class="token punctuation">(</span><span class="token variable">@j</span><span class="token punctuation">,</span> <span class="token string">&#39;$.a&#39;</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">&#39;$.c&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;[true, false]&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- {&quot;a&quot;: 1, &quot;b&quot;: [2, 3], &quot;c&quot;: &quot;[true, false]&quot;} //注意a节点没有更新</span>
<span class="token keyword">SELECT</span> JSON_INSERT<span class="token punctuation">(</span><span class="token variable">@j</span><span class="token punctuation">,</span> <span class="token string">&#39;$.a&#39;</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">&#39;$.c&#39;</span><span class="token punctuation">,</span> CAST<span class="token punctuation">(</span><span class="token string">&#39;[true, false]&#39;</span> <span class="token keyword">AS</span> JSON<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- {&quot;a&quot;: 1, &quot;b&quot;: [2, 3], &quot;c&quot;: [true, false]} </span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>4.<code>JSON_MERGE(json_doc, json_doc[, json_doc] ...)</code></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> JSON_MERGE<span class="token punctuation">(</span><span class="token string">&#39;[1, 2]&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;[true, false]&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>5.<code>JSON_MERGE_PATCH(json_doc, json_doc[, json_doc] ...)</code></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> JSON_MERGE_PATCH<span class="token punctuation">(</span><span class="token string">&#39;[1, 2]&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;[true, false]&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- [true, false]</span>
<span class="token keyword">SELECT</span> JSON_MERGE_PATCH<span class="token punctuation">(</span><span class="token string">&#39;{&quot;name&quot;: &quot;x&quot;}&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;{&quot;id&quot;: 47}&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- {&quot;id&quot;: 47, &quot;name&quot;: &quot;x&quot;}</span>
<span class="token keyword">SELECT</span> JSON_MERGE_PATCH<span class="token punctuation">(</span><span class="token string">&#39;1&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;true&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">-- true</span>
<span class="token keyword">SELECT</span> JSON_MERGE_PATCH<span class="token punctuation">(</span><span class="token string">&#39;[1, 2]&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;{&quot;id&quot;: 47}&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">-- {&quot;id&quot;: 47}</span>
<span class="token keyword">SELECT</span> JSON_MERGE_PATCH<span class="token punctuation">(</span><span class="token string">&#39;{ &quot;a&quot;: 1, &quot;b&quot;:2 }&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;{ &quot;a&quot;: 3, &quot;c&quot;:4 }&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;{ &quot;a&quot;: 5, &quot;d&quot;:6 }&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- {&quot;a&quot;: 5, &quot;b&quot;: 2, &quot;c&quot;: 4, &quot;d&quot;: 6}</span>
<span class="token keyword">SELECT</span> JSON_MERGE_PATCH<span class="token punctuation">(</span><span class="token string">&#39;{&quot;a&quot;:1, &quot;b&quot;:2}&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;{&quot;b&quot;:null}&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- {&quot;a&quot;: 1}</span>
<span class="token keyword">SELECT</span> JSON_MERGE_PATCH<span class="token punctuation">(</span><span class="token string">&#39;{&quot;a&quot;:{&quot;x&quot;:1}}&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;{&quot;a&quot;:{&quot;y&quot;:2}}&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- {&quot;a&quot;: {&quot;x&quot;: 1, &quot;y&quot;: 2}}  </span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>6.<code>JSON_MERGE_PRESERVE(json_doc, json_doc[, json_doc] ...)</code></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> JSON_MERGE_PRESERVE<span class="token punctuation">(</span><span class="token string">&#39;[1, 2]&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;[true, false]&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- [1, 2, true, false]</span>
<span class="token keyword">SELECT</span> JSON_MERGE_PRESERVE<span class="token punctuation">(</span><span class="token string">&#39;{&quot;name&quot;: &quot;x&quot;}&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;{&quot;id&quot;: 47}&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- {&quot;id&quot;: 47, &quot;name&quot;: &quot;x&quot;}</span>
<span class="token keyword">SELECT</span> JSON_MERGE_PRESERVE<span class="token punctuation">(</span><span class="token string">&#39;1&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;true&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- [1, true]</span>
<span class="token keyword">SELECT</span> JSON_MERGE_PRESERVE<span class="token punctuation">(</span><span class="token string">&#39;[1, 2]&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;{&quot;id&quot;: 47}&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- [1, 2, {&quot;id&quot;: 47}]</span>
<span class="token keyword">SELECT</span> JSON_MERGE_PRESERVE<span class="token punctuation">(</span><span class="token string">&#39;{ &quot;a&quot;: 1, &quot;b&quot;: 2 }&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;{ &quot;a&quot;: 3, &quot;c&quot;: 4 }&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- {&quot;a&quot;: [1, 3], &quot;b&quot;: 2, &quot;c&quot;: 4}</span>
<span class="token keyword">SELECT</span> JSON_MERGE_PRESERVE<span class="token punctuation">(</span><span class="token string">&#39;{ &quot;a&quot;: 1, &quot;b&quot;: 2 }&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;{ &quot;a&quot;: 3, &quot;c&quot;: 4 }&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;{ &quot;a&quot;: 5, &quot;d&quot;: 6 }&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- {&quot;a&quot;: [1, 3, 5], &quot;b&quot;: 2, &quot;c&quot;: 4, &quot;d&quot;: 6}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>7.<code>JSON_REMOVE(json_doc, path[, path] ...)</code></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SET</span> <span class="token variable">@j</span> <span class="token operator">=</span> <span class="token string">&#39;[&quot;a&quot;, [&quot;b&quot;, &quot;c&quot;], &quot;d&quot;]&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> JSON_REMOVE<span class="token punctuation">(</span><span class="token variable">@j</span><span class="token punctuation">,</span> <span class="token string">&#39;$[1]&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- [&quot;a&quot;, &quot;d&quot;]</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>8.<code>JSON_REPLACE(json_doc, path, val[, path, val] ...)</code></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SET</span> <span class="token variable">@j</span> <span class="token operator">=</span> <span class="token string">&#39;{ &quot;a&quot;: 1, &quot;b&quot;: [2, 3]}&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> JSON_REPLACE<span class="token punctuation">(</span><span class="token variable">@j</span><span class="token punctuation">,</span> <span class="token string">&#39;$.a&#39;</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">&#39;$.c&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;[true, false]&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- {&quot;a&quot;: 10, &quot;b&quot;: [2, 3]}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>9.<code>JSON_SET(json_doc, path, val[, path, val] ...)</code></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SET</span> <span class="token variable">@j</span> <span class="token operator">=</span> <span class="token string">&#39;{ &quot;a&quot;: 1, &quot;b&quot;: [2, 3]}&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> JSON_SET<span class="token punctuation">(</span><span class="token variable">@j</span><span class="token punctuation">,</span> <span class="token string">&#39;$.a&#39;</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">&#39;$.c&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;[true, false]&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">-- {&quot;a&quot;: 10, &quot;b&quot;: [2, 3], &quot;c&quot;: &quot;[true, false]&quot;}</span>
<span class="token keyword">SELECT</span> JSON_INSERT<span class="token punctuation">(</span><span class="token variable">@j</span><span class="token punctuation">,</span> <span class="token string">&#39;$.a&#39;</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">&#39;$.c&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;[true, false]&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- {&quot;a&quot;: 1, &quot;b&quot;: [2, 3], &quot;c&quot;: &quot;[true, false]&quot;}</span>
<span class="token keyword">SELECT</span> JSON_REPLACE<span class="token punctuation">(</span><span class="token variable">@j</span><span class="token punctuation">,</span> <span class="token string">&#39;$.a&#39;</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">&#39;$.c&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;[true, false]&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- {&quot;a&quot;: 10, &quot;b&quot;: [2, 3]}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>10.<code>JSON_UNQUOTE(json_val)</code></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SET</span> <span class="token variable">@j</span> <span class="token operator">=</span> <span class="token string">&#39;&quot;abc&quot;&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token variable">@j</span><span class="token punctuation">,</span> JSON_UNQUOTE<span class="token punctuation">(</span><span class="token variable">@j</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">-- &quot;abc&quot; | abc</span>
<span class="token keyword">SET</span> <span class="token variable">@j</span> <span class="token operator">=</span> <span class="token string">&#39;[1, 2, 3]&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token variable">@j</span><span class="token punctuation">,</span> JSON_UNQUOTE<span class="token punctuation">(</span><span class="token variable">@j</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- [1, 2, 3] | [1, 2, 3]</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="json-value-attributes" tabindex="-1"><a class="header-anchor" href="#json-value-attributes" aria-hidden="true">#</a> json value attributes</h3><table><thead><tr><th>方法</th><th>描述</th></tr></thead><tbody><tr><td><code>JSON_DEPTH(json_doc)</code></td><td></td></tr><tr><td><code>JSON_LENGTH(json_doc[, path])</code></td><td></td></tr><tr><td><code>JSON_TYPE(json_val)</code></td><td></td></tr><tr><td><code>JSON_VALID(val)</code></td><td></td></tr></tbody></table><p>1.<code>JSON_DEPTH(json_doc)</code></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> JSON_DEPTH<span class="token punctuation">(</span><span class="token string">&#39;{}&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> JSON_DEPTH<span class="token punctuation">(</span><span class="token string">&#39;[]&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> JSON_DEPTH<span class="token punctuation">(</span><span class="token string">&#39;true&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- 1 |  1 |   1</span>
<span class="token keyword">SELECT</span> JSON_DEPTH<span class="token punctuation">(</span><span class="token string">&#39;[10, 20]&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> JSON_DEPTH<span class="token punctuation">(</span><span class="token string">&#39;[[], {}]&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- 2 | 2</span>
<span class="token keyword">SELECT</span> JSON_DEPTH<span class="token punctuation">(</span><span class="token string">&#39;[10, {&quot;a&quot;: 20}]&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- 3</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>2.<code>JSON_LENGTH(json_doc[, path])</code></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> JSON_LENGTH<span class="token punctuation">(</span><span class="token string">&#39;[1, 2, {&quot;a&quot;: 3}]&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- 3</span>
<span class="token keyword">SELECT</span> JSON_LENGTH<span class="token punctuation">(</span><span class="token string">&#39;{&quot;a&quot;: 1, &quot;b&quot;: {&quot;c&quot;: 30}}&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- 2</span>
<span class="token keyword">SELECT</span> JSON_LENGTH<span class="token punctuation">(</span><span class="token string">&#39;{&quot;a&quot;: 1, &quot;b&quot;: {&quot;c&quot;: 30}}&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;$.b&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- 1</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>3.<code>JSON_TYPE(json_val)</code></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SET</span> <span class="token variable">@j</span> <span class="token operator">=</span> <span class="token string">&#39;{&quot;a&quot;: [10, true]}&#39;</span><span class="token punctuation">;</span> <span class="token comment">--OBJECT</span>
<span class="token keyword">SELECT</span> JSON_TYPE<span class="token punctuation">(</span>JSON_EXTRACT<span class="token punctuation">(</span><span class="token variable">@j</span><span class="token punctuation">,</span> <span class="token string">&#39;$.a&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">--ARRAY</span>
<span class="token keyword">SELECT</span> JSON_TYPE<span class="token punctuation">(</span>JSON_EXTRACT<span class="token punctuation">(</span><span class="token variable">@j</span><span class="token punctuation">,</span> <span class="token string">&#39;$.a[0]&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">--INTEGER</span>
<span class="token keyword">SELECT</span> JSON_TYPE<span class="token punctuation">(</span>JSON_EXTRACT<span class="token punctuation">(</span><span class="token variable">@j</span><span class="token punctuation">,</span> <span class="token string">&#39;$.a[1]&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">--BOOLEAN</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>4.<code>JSON_VALID(val)</code></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> JSON_VALID<span class="token punctuation">(</span><span class="token string">&#39;{&quot;a&quot;: 1}&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- 1</span>
<span class="token keyword">SELECT</span> JSON_VALID<span class="token punctuation">(</span><span class="token string">&#39;hello&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> JSON_VALID<span class="token punctuation">(</span><span class="token string">&#39;&quot;hello&quot;&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- 0 | 1 </span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>refs: https://dev.mysql.com/doc/refman/8.0/en/json.html https://dev.mysql.com/doc/refman/8.0/en/json-function-reference.html https://dev.mysql.com/doc/refman/8.0/en/json-search-functions.html https://blog.csdn.net/weixin_33772645/article/details/86031723 https://www.cnblogs.com/ooo0/p/9309277.html</p>`,60),e=[o];function c(l,u){return s(),a("div",null,e)}const r=n(p,[["render",c],["__file","json.html.vue"]]);export{r as default};
