import{_ as e}from"./plugin-vue_export-helper-x3n3nnut.js";import{r as t,o,c as p,b as n,d as s,e as c,a as i}from"./app-7knaTE3M.js";const l={},r=n("h1",{id:"faiss",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#faiss","aria-hidden":"true"},"#"),s(" faiss")],-1),u=n("h2",{id:"简介",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#简介","aria-hidden":"true"},"#"),s(" 简介")],-1),d={href:"https://link.zhihu.com/?target=https%3A//github.com/facebookresearch/faiss",target:"_blank",rel:"noopener noreferrer"},k=i(`<p>Faiss的主要原理是构建base vectors向量数据的index索引，然后利用索引对search vectors 实现 TopK 相似向量检索。</p><p>Faiss支持许多不同的构建索引的方式，以下是一些较推荐使用的类型。</p><ol><li>&quot;Flat&quot;：暴力精确检索，全局最优，适合数十万级。</li><li>&quot;IVF100,Flat&quot;：倒排暴力检索(100聚类后暴力检索)，非全局最优但召回高，适合数百万级。</li><li>”HNSW64&quot;: 图网络检索，Hierarchical NSW(Navigable Small World)，检索复杂度log(logn)，适合千万上亿规模以及更大规模的图索引，缺点是构建索引过程较慢，占用很大的存储。</li></ol><h2 id="最佳实践" tabindex="-1"><a class="header-anchor" href="#最佳实践" aria-hidden="true">#</a> 最佳实践</h2><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">import</span> faiss
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np 


<span class="token comment"># 创建数据</span>
d <span class="token operator">=</span> <span class="token number">128</span>  <span class="token comment"># 向量的维度</span>
n <span class="token operator">=</span> <span class="token number">10000</span>  <span class="token comment"># 向量的数量</span>
data <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> d<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token string">&#39;float32&#39;</span><span class="token punctuation">)</span>  <span class="token comment"># 创建随机向量</span>

<span class="token comment"># 创建索引</span>
index <span class="token operator">=</span> faiss<span class="token punctuation">.</span>IndexFlatL2<span class="token punctuation">(</span>d<span class="token punctuation">)</span>  <span class="token comment"># L2距离度量的平面索引</span>

<span class="token comment"># 创建索引后，我们需要将向量数据添加到索引中。</span>
index<span class="token punctuation">.</span>add<span class="token punctuation">(</span>data<span class="token punctuation">)</span>  <span class="token comment"># 将数据添加到索引中</span>

k <span class="token operator">=</span> <span class="token number">5</span>  <span class="token comment"># 查找最相似的前5个向量</span>
query_vector <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> d<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token string">&#39;float32&#39;</span><span class="token punctuation">)</span>  <span class="token comment"># 创建一个查询向量</span>
distances<span class="token punctuation">,</span> indices <span class="token operator">=</span> index<span class="token punctuation">.</span>search<span class="token punctuation">(</span>query_vector<span class="token punctuation">,</span> k<span class="token punctuation">)</span>  <span class="token comment"># 搜索, indices是与查询向量最相似的向量的索引, distances是对应的L2距离。</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="参考" tabindex="-1"><a class="header-anchor" href="#参考" aria-hidden="true">#</a> 参考</h2><ol><li>https://blog.csdn.net/weixin_43114209/article/details/141716443</li><li>https://zhuanlan.zhihu.com/p/357414033</li><li>https://zhuanlan.zhihu.com/p/379372268</li><li>https://github.com/facebookresearch/faiss/wiki/Getting-started</li></ol>`,7);function m(h,v){const a=t("ExternalLinkIcon");return o(),p("div",null,[r,u,n("p",null,[s("Faiss全称"),n("a",d,[s("Facebook AI Similarity Search"),c(a)]),s("，是FaceBook的AI团队针对大规模向量 进行 TopK 相似向量 检索 的一个工具，使用C++编写，有python接口，对10亿量级的索引可以做到毫秒级检索的性能。")]),k])}const _=e(l,[["render",m],["__file","3faiss.html.vue"]]);export{_ as default};
