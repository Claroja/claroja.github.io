const s=JSON.parse(`{"key":"v-343318ee","path":"/%E6%95%B0%E6%8D%AE%E5%B7%A5%E7%A8%8B/spark/function/session.html","title":"session","lang":"zh-CN","frontmatter":{"description":"session ## coding:utf8 ## SparkSession对象的导包, 对象是来自于 pyspark.sql包中 from pyspark.sql import SparkSession ## 构建SparkSession执行环境入口对象 spark = SparkSession.builder.\\\\ appName(\\"test\\").\\\\ master(\\"local[*]\\").\\\\ getOrCreate() ## sc = spark.sparkContext # 通过SparkSession对象 获取 SparkContext对象 ## 创建dataframe df = spark.read.csv(\\"../data/input/stu_score.txt\\", sep=',', header=False) df2 = df.toDF(\\"id\\", \\"name\\", \\"score\\") df2.printSchema() # 查看表结构 df2.show() # 查看表内容 ## DSL 风格 df2.where(\\"name='语文'\\").limit(5).show() ## SQL 风格 df2.createTempView(\\"score\\") spark.sql(\\"\\"\\" SELECT * FROM score WHERE name='语文' LIMIT 5 \\"\\"\\").show()","head":[["meta",{"property":"og:url","content":"https://claroja.github.io/%E6%95%B0%E6%8D%AE%E5%B7%A5%E7%A8%8B/spark/function/session.html"}],["meta",{"property":"og:site_name","content":"Claroja"}],["meta",{"property":"og:title","content":"session"}],["meta",{"property":"og:description","content":"session ## coding:utf8 ## SparkSession对象的导包, 对象是来自于 pyspark.sql包中 from pyspark.sql import SparkSession ## 构建SparkSession执行环境入口对象 spark = SparkSession.builder.\\\\ appName(\\"test\\").\\\\ master(\\"local[*]\\").\\\\ getOrCreate() ## sc = spark.sparkContext # 通过SparkSession对象 获取 SparkContext对象 ## 创建dataframe df = spark.read.csv(\\"../data/input/stu_score.txt\\", sep=',', header=False) df2 = df.toDF(\\"id\\", \\"name\\", \\"score\\") df2.printSchema() # 查看表结构 df2.show() # 查看表内容 ## DSL 风格 df2.where(\\"name='语文'\\").limit(5).show() ## SQL 风格 df2.createTempView(\\"score\\") spark.sql(\\"\\"\\" SELECT * FROM score WHERE name='语文' LIMIT 5 \\"\\"\\").show()"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2023-11-27T13:17:01.000Z"}],["meta",{"property":"article:author","content":"claroja"}],["meta",{"property":"article:modified_time","content":"2023-11-27T13:17:01.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"session\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2023-11-27T13:17:01.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"claroja\\",\\"url\\":\\"https://claroja.github.io\\"}]}"]]},"headers":[],"git":{"createdTime":1701091021000,"updatedTime":1701091021000,"contributors":[{"name":"claroja","email":"63183535@qq.com","commits":1}]},"readingTime":{"minutes":0.36,"words":109},"filePathRelative":"数据工程/spark/function/session.md","localizedDate":"2023年11月27日","excerpt":"<h1> session</h1>\\n<div class=\\"language-python line-numbers-mode\\" data-ext=\\"py\\"><pre class=\\"language-python\\"><code><span class=\\"token comment\\">## coding:utf8</span>\\n\\n<span class=\\"token comment\\">## SparkSession对象的导包, 对象是来自于 pyspark.sql包中</span>\\n<span class=\\"token keyword\\">from</span> pyspark<span class=\\"token punctuation\\">.</span>sql <span class=\\"token keyword\\">import</span> SparkSession\\n\\n<span class=\\"token comment\\">## 构建SparkSession执行环境入口对象</span>\\nspark <span class=\\"token operator\\">=</span> SparkSession<span class=\\"token punctuation\\">.</span>builder<span class=\\"token punctuation\\">.</span>\\\\\\n    appName<span class=\\"token punctuation\\">(</span><span class=\\"token string\\">\\"test\\"</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">.</span>\\\\\\n    master<span class=\\"token punctuation\\">(</span><span class=\\"token string\\">\\"local[*]\\"</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">.</span>\\\\\\n    getOrCreate<span class=\\"token punctuation\\">(</span><span class=\\"token punctuation\\">)</span>\\n<span class=\\"token comment\\">## sc = spark.sparkContext # 通过SparkSession对象 获取 SparkContext对象</span>\\n\\n\\n\\n<span class=\\"token comment\\">## 创建dataframe</span>\\ndf <span class=\\"token operator\\">=</span> spark<span class=\\"token punctuation\\">.</span>read<span class=\\"token punctuation\\">.</span>csv<span class=\\"token punctuation\\">(</span><span class=\\"token string\\">\\"../data/input/stu_score.txt\\"</span><span class=\\"token punctuation\\">,</span> sep<span class=\\"token operator\\">=</span><span class=\\"token string\\">','</span><span class=\\"token punctuation\\">,</span> header<span class=\\"token operator\\">=</span><span class=\\"token boolean\\">False</span><span class=\\"token punctuation\\">)</span>\\ndf2 <span class=\\"token operator\\">=</span> df<span class=\\"token punctuation\\">.</span>toDF<span class=\\"token punctuation\\">(</span><span class=\\"token string\\">\\"id\\"</span><span class=\\"token punctuation\\">,</span> <span class=\\"token string\\">\\"name\\"</span><span class=\\"token punctuation\\">,</span> <span class=\\"token string\\">\\"score\\"</span><span class=\\"token punctuation\\">)</span>\\ndf2<span class=\\"token punctuation\\">.</span>printSchema<span class=\\"token punctuation\\">(</span><span class=\\"token punctuation\\">)</span>  <span class=\\"token comment\\"># 查看表结构</span>\\ndf2<span class=\\"token punctuation\\">.</span>show<span class=\\"token punctuation\\">(</span><span class=\\"token punctuation\\">)</span>  <span class=\\"token comment\\"># 查看表内容</span>\\n\\n<span class=\\"token comment\\">## DSL 风格</span>\\ndf2<span class=\\"token punctuation\\">.</span>where<span class=\\"token punctuation\\">(</span><span class=\\"token string\\">\\"name='语文'\\"</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">.</span>limit<span class=\\"token punctuation\\">(</span><span class=\\"token number\\">5</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">.</span>show<span class=\\"token punctuation\\">(</span><span class=\\"token punctuation\\">)</span>\\n<span class=\\"token comment\\">## SQL 风格</span>\\ndf2<span class=\\"token punctuation\\">.</span>createTempView<span class=\\"token punctuation\\">(</span><span class=\\"token string\\">\\"score\\"</span><span class=\\"token punctuation\\">)</span>\\n\\nspark<span class=\\"token punctuation\\">.</span>sql<span class=\\"token punctuation\\">(</span><span class=\\"token triple-quoted-string string\\">\\"\\"\\"\\n    SELECT * FROM score WHERE name='语文' LIMIT 5\\n\\"\\"\\"</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">.</span>show<span class=\\"token punctuation\\">(</span><span class=\\"token punctuation\\">)</span>\\n</code></pre><div class=\\"line-numbers\\" aria-hidden=\\"true\\"><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div></div></div>","copyright":{"author":"王新宇"},"autoDesc":true}`);export{s as data};
